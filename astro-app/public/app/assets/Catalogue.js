import{r as g,l as os,m as ee,s as _e,j as e,D as de,n as oe,o as me,p as ue,q as We,v as xe,B as f,I as F,P as Ze,A as ks,d as ms,C as G,c as Y,a as Fe,b as De,t as ke,e as V,X as $e,aC as Is,aD as Ps,aE as Es,ak as Ue,y as zs,g as us,aF as aa,ah as ia,R as le,W as ra,ae as Ms,V as ta,aG as Fs,af as la,aH as na,a3 as Ds,aI as ca,aJ as da,a4 as oa,a5 as ma,aK as ua,aL as ha,aM as xa,aN as pa,aO as ja,aP as ga}from"./index.js";import{u as hs}from"./useCatalogue.js";import{I as Le,C as bs}from"./CatalogueCreator.js";import{T as Be}from"./textarea.js";import{S as pe}from"./switch.js";import{S as Xe}from"./scroll-area.js";import{A as ye,a as we,b as qe}from"./alert.js";import{a as Ce,u as es}from"./useRestaurantSettings.js";import{P as ce}from"./plus.js";import{C as Ve}from"./circle-alert.js";import{T as be}from"./trash-2.js";import{A as fa}from"./arrow-left.js";import{L as ne}from"./loader-circle.js";import{C as Ee}from"./check.js";import{u as Ts}from"./useQuery.js";import{L as E}from"./label.js";import{S as ge,a as fe,b as ve,c as Ne,d as ie,C as xs}from"./select.js";import{T as ls,a as ns,b as ze,c as W,d as cs,e as X}from"./table.js";import{C as Se,u as va,a as Na,b as ys,D as _a,c as ba,S as ya,r as wa,d as Ca,s as Sa,K as Aa,P as ka,e as Ia,f as Pa}from"./sortable.esm.js";import{C as Os}from"./ConfirmDialog.js";import{P as Me,I as Rs,G as Ea}from"./pencil.js";import{P as za,a as Ma,b as Fa}from"./popover.js";import{C as Da}from"./clock.js";import{S as Je}from"./search.js";import{C as Ta}from"./calendar.js";import{a as Oa,Z as Ra,R as Ua}from"./zoom-out.js";import{D as La}from"./download.js";import{U as ts}from"./upload.js";import{E as $a}from"./eye.js";import{u as qa}from"./index3.js";import{T as Va,a as Ha,b as Re,c as Pe}from"./tabs.js";import{L as Ka,A as Ga}from"./leaf.js";import{T as Qa}from"./triangle-alert.js";import{L as ws}from"./lightbulb.js";import{S as Ba}from"./save.js";import"./index5.js";import"./index4.js";import"./alert-dialog.js";import"./index2.js";function Za(a){const[o,l]=g.useState([]),r=os(),h=Ce({mutationFn:async u=>{if(!a)throw new Error("Utilisateur non identifi√©");const b=[];let _=0;for(const y of u)for(const x of y.products)b.push({user_id:a,name:x.name,ingredient:x.ingredient||[],category:y.name,description:x.description||"",unit_price:x.unit_price||0,currency:x.currency||"EUR",vat_rate:x.vat_rate||10,is_active:x.is_active!==!1,tags:x.tags||[],allergens:x.allergens||[],sort_order:_++});if(b.length===0)throw new Error("Aucun produit √† ajouter");const{error:m}=await _e.from("products").insert(b);if(m)throw console.error("Error inserting products:",m),m;return{count:b.length}},onSuccess:u=>{ee.success(`${u.count} produit(s) ajout√©(s) avec succ√®s`),l([]),r.invalidateQueries({queryKey:["catalogue-items",a]})},onError:u=>{console.error("Erreur ajout catalogue:",u),ee.error("Erreur lors de l'ajout",{description:u.message})}});return{categories:o,setCategories:l,addCategories:h.mutate,isAdding:h.isPending}}function Ja({open:a,onOpenChange:o,userId:l,existingCategories:r}){const[h,u]=g.useState(1),[b,_]=g.useState(0),{categories:m,setCategories:y,addCategories:x,isAdding:C}=Za(l),d=()=>{u(1),_(0),y([]),o(!1)},j=()=>{y([...m,{id:crypto.randomUUID(),name:"",products:[]}])},p=n=>{y(m.filter(S=>S.id!==n))},P=(n,S)=>{y(m.map(A=>A.id===n?{...A,name:S}:A))},O=()=>{if(m.length===0||m.some(n=>!n.name.trim())){alert("Veuillez renseigner toutes les cat√©gories");return}u(2),_(0)},T=n=>{const S={id:crypto.randomUUID(),name:"",ingredient:[],description:"",unit_price:0,currency:"EUR",vat_rate:10,is_active:!0,tags:[],allergens:[]};y(m.map(A=>A.id===n?{...A,products:[...A.products,S]}:A))},$=(n,S)=>{y(m.map(A=>A.id===n?{...A,products:A.products.filter(Q=>Q.id!==S)}:A))},c=(n,S,A,Q)=>{y(m.map(J=>J.id===n?{...J,products:J.products.map(i=>i.id===S?{...i,[A]:Q}:i)}:J))},w=()=>{const n=m[b];if(n.products.length===0||n.products.some(S=>!S.name.trim())){alert("Veuillez renseigner au moins un produit avec un nom");return}b<m.length-1?_(b+1):u(3)},N=()=>{b>0&&_(b-1)},U=()=>{x(m),d()},M=m[b],R=m.reduce((n,S)=>n+S.products.length,0);return e.jsx(de,{open:a,onOpenChange:d,children:e.jsxs(oe,{className:"max-w-4xl max-h-[90vh]",children:[e.jsxs(me,{children:[e.jsx(ue,{children:"Ajouter des cat√©gories et produits"}),e.jsxs(We,{children:[h===1&&"Ajoutez vos nouvelles cat√©gories",h===2&&`Ajoutez les produits de la cat√©gorie "${M==null?void 0:M.name}"`,h===3&&"V√©rifiez et validez vos ajouts"]})]}),e.jsx("div",{className:"flex items-center justify-center gap-2 mb-6",children:[1,2,3].map(n=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:xe("w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold transition-colors",h>=n?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:n}),n<3&&e.jsx("div",{className:xe("w-16 h-0.5 mx-2",h>n?"bg-primary":"bg-muted")})]},n))}),e.jsxs(Xe,{className:"flex-1 pr-4",style:{maxHeight:"calc(90vh - 250px)"},children:[h===1&&e.jsxs("div",{className:"space-y-4",children:[r.length>0&&e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground",children:"Cat√©gories existantes"}),r.map(n=>e.jsx("div",{className:"p-3 bg-muted/50 rounded-lg text-sm",children:n},n))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold",children:"Nouvelles cat√©gories"}),e.jsxs(f,{onClick:j,size:"sm",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Ajouter une cat√©gorie"]})]}),m.length===0&&e.jsxs(ye,{children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsx(we,{children:"Commencez par ajouter au moins une cat√©gorie"})]}),m.map(n=>e.jsx("div",{className:"p-4 border rounded-lg space-y-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{placeholder:"Nom de la cat√©gorie *",value:n.name,onChange:S=>P(n.id,S.target.value),className:"flex-1"}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>p(n.id),className:"text-destructive hover:text-destructive",children:e.jsx(be,{className:"h-4 w-4"})})]})},n.id))]})]}),h===2&&M&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:M.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Cat√©gorie ",b+1," sur ",m.length]})]}),e.jsxs(f,{onClick:()=>T(M.id),size:"sm",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Ajouter un produit"]})]}),M.products.length===0&&e.jsxs(ye,{children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsx(we,{children:"Ajoutez au moins un produit pour cette cat√©gorie"})]}),M.products.map((n,S)=>e.jsxs("div",{className:"p-4 border rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:["Produit #",S+1]}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>$(M.id,n.id),className:"text-destructive hover:text-destructive",children:e.jsx(be,{className:"h-4 w-4"})})]}),e.jsx(F,{placeholder:"Nom du produit *",value:n.name,onChange:A=>c(M.id,n.id,"name",A.target.value)}),e.jsx(Le,{value:n.ingredient,onChange:A=>c(M.id,n.id,"ingredient",A),placeholder:"Ajouter des ingr√©dients..."}),e.jsx(Be,{placeholder:"Description",value:n.description,onChange:A=>c(M.id,n.id,"description",A.target.value),rows:2}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(F,{type:"number",placeholder:"Prix unitaire",value:n.unit_price||"",onChange:A=>c(M.id,n.id,"unit_price",parseFloat(A.target.value)||0)}),e.jsx(F,{type:"number",placeholder:"TVA (%)",value:n.vat_rate||"",onChange:A=>c(M.id,n.id,"vat_rate",parseFloat(A.target.value)||0)})]}),e.jsx(Le,{value:n.tags,onChange:A=>c(M.id,n.id,"tags",A),placeholder:"Ajouter des tags..."}),e.jsx(Le,{value:n.allergens,onChange:A=>c(M.id,n.id,"allergens",A),placeholder:"Ajouter des allerg√®nes..."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{checked:n.is_active,onCheckedChange:A=>c(M.id,n.id,"is_active",A)}),e.jsx("span",{className:"text-sm",children:"Produit actif"})]})]},n.id))]}),h===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ye,{children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsxs(we,{children:["Vous √™tes sur le point d'ajouter ",e.jsxs("strong",{children:[m.length," cat√©gorie(s)"]})," et ",e.jsxs("strong",{children:[R," produit(s)"]})," √† votre catalogue."]})]}),m.map(n=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-semibold text-lg",children:[n.name," (",n.products.length," produits)"]}),e.jsx("div",{className:"space-y-2",children:n.products.map(S=>e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("p",{className:"font-medium",children:S.name}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold",children:[S.unit_price.toFixed(2)," ",S.currency]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["TVA ",S.vat_rate,"%"]})]})]}),S.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:S.description})]},S.id))})]},n.id))]})]}),e.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[e.jsxs(f,{variant:"outline",onClick:h===1?d:h===2?b>0?N:()=>u(1):()=>u(2),disabled:C,children:[e.jsx(fa,{className:"h-4 w-4 mr-2"}),h===1?"Annuler":"Retour"]}),e.jsx(f,{onClick:h===1?O:h===2?w:U,disabled:C||h===1&&m.length===0,children:C?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"h-4 w-4 mr-2 animate-spin"}),"Ajout en cours..."]}):h===3?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Ajouter au catalogue"]}):e.jsxs(e.Fragment,{children:["Suivant",e.jsx(ks,{className:"h-4 w-4 ml-2"})]})})]})]})})}const Ya=a=>{const o=os(),{profile:l}=ms(),r=(a==null?void 0:a.userId)??(l==null?void 0:l.user_id),{data:h,isLoading:u,error:b}=Ts({queryKey:["addons",r],queryFn:async()=>{if(!r)return[];const{data:x,error:C}=await _e.from("addons").select("*").eq("user_id",r).order("sort_order").order("label");if(C)throw console.error("Error fetching addons:",C),C;return(x||[]).map(d=>({id:d.id,label:d.label,price:d.price,applies_to_type:d.applies_to_type,applies_to_value:d.applies_to_value,max_per_item:d.max_per_item,is_active:d.is_active}))},enabled:!!r}),_=Ce({mutationFn:async x=>{if(!r)throw new Error("Utilisateur non connect√©");const C=x.map(j=>({id:j.id,user_id:r,label:j.label,price:j.price,applies_to_type:j.applies_to_type,applies_to_value:j.applies_to_value,max_per_item:j.max_per_item,is_active:j.is_active,updated_at:new Date().toISOString()})),{error:d}=await _e.from("addons").upsert(C,{onConflict:"id"});if(d)throw d},onSuccess:()=>{ee.success("Suppl√©ments enregistr√©s"),o.invalidateQueries({queryKey:["addons",r]})},onError:x=>{ee.error(`Erreur: ${x.message}`)}}),m=Ce({mutationFn:async x=>{if(!r)throw new Error("Utilisateur non connect√©");const{error:C}=await _e.from("addons").upsert({id:x.id,user_id:r,label:x.label,price:x.price,applies_to_type:x.applies_to_type,applies_to_value:x.applies_to_value,max_per_item:x.max_per_item,is_active:x.is_active,updated_at:new Date().toISOString()},{onConflict:"id"});if(C)throw C},onSuccess:()=>{ee.success("Suppl√©ment enregistr√©"),o.invalidateQueries({queryKey:["addons",r]})},onError:x=>{ee.error(`Erreur: ${x.message}`)}}),y=Ce({mutationFn:async x=>{if(!r||!x.id)throw new Error("Utilisateur non connect√©");const{error:C}=await _e.from("addons").delete().eq("id",x.id).eq("user_id",r);if(C)throw C},onSuccess:()=>{ee.success("Suppl√©ment supprim√©"),o.invalidateQueries({queryKey:["addons",r]})},onError:x=>{ee.error(`Erreur: ${x.message}`)}});return{addons:h||[],isLoading:u,error:b,hasConfig:!!r,saveAddons:_.mutate,saveAddon:m.mutate,isSaving:_.isPending||m.isPending,deleteAddon:y.mutate,isDeleting:y.isPending}};function Wa({userId:a}){var i;const{addons:o,isLoading:l,hasConfig:r,saveAddon:h,isSaving:u,deleteAddon:b,isDeleting:_}=Ya({userId:a}),{items:m}=hs({userId:a}),[y,x]=g.useState([]),[C,d]=g.useState(!1),[j,p]=g.useState(!1),[P,O]=g.useState(null),[T,$]=g.useState({open:!1,addon:null}),[c,w]=g.useState({label:"",price:0,applies_to_type:"global",applies_to_value:"*",selected_products:[],max_per_item:1,is_active:!0}),[N,U]=g.useState({label:"",price:0,applies_to_type:"global",applies_to_value:"*",selected_products:[],max_per_item:1,is_active:!0});g.useEffect(()=>{x(o)},[o]);const M=Array.from(new Set(m.map(s=>s.category))),R=()=>{const s={id:crypto.randomUUID(),label:c.label,price:c.price,applies_to_type:c.applies_to_type,applies_to_value:c.applies_to_type==="product"?c.selected_products.join("|"):c.applies_to_value,max_per_item:c.max_per_item,is_active:c.is_active};x([...y,s]),h(s),d(!1),w({label:"",price:0,applies_to_type:"global",applies_to_value:"*",selected_products:[],max_per_item:1,is_active:!0})},n=s=>{O(s);const v=s.applies_to_type==="product"?s.applies_to_value.split("|"):[];U({label:s.label||"",price:s.price??0,applies_to_type:s.applies_to_type||"global",applies_to_value:s.applies_to_value||"*",selected_products:v,max_per_item:s.max_per_item||1,is_active:s.is_active??!0}),p(!0)},S=()=>{if(!P)return;const s={...P,label:N.label,price:N.price,applies_to_type:N.applies_to_type,applies_to_value:N.applies_to_type==="product"?N.selected_products.join("|"):N.applies_to_value,max_per_item:N.max_per_item,is_active:N.is_active};x(v=>v.map(k=>k.id===s.id?s:k)),h(s),p(!1),O(null)},A=s=>{$({open:!0,addon:s})},Q=()=>{T.addon&&(x(s=>s.filter(v=>v.id!==T.addon.id)),b(T.addon),$({open:!1,addon:null}))},J=s=>s.applies_to_type==="global"?"üåç Tous les produits":s.applies_to_type==="category"?`üìÇ ${s.applies_to_value}`:s.applies_to_type==="product"?`üì¶ ${s.applies_to_value.split("|").map(D=>{const B=m.find(se=>se.id===D);return B?B.name:D}).join(", ")}`:s.applies_to_value;return r?l?e.jsx(G,{children:e.jsx(Y,{className:"flex items-center justify-center py-12",children:e.jsx(ne,{className:"h-8 w-8 animate-spin text-muted-foreground"})})}):y.length===0?e.jsxs(e.Fragment,{children:[e.jsxs(G,{children:[e.jsx(Fe,{children:e.jsxs(De,{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsx("span",{children:"Suppl√©ments"}),e.jsxs(f,{onClick:()=>d(!0),className:"w-full sm:w-auto",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"Ajouter"]})]})}),e.jsx(Y,{children:e.jsxs(ye,{children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx(qe,{children:"Aucun suppl√©ment d√©fini"}),e.jsx(we,{children:"Ajoutez des suppl√©ments pour permettre √† vos clients de personnaliser leurs commandes (ex : Fromage +, Sauce +, etc.)"})]})})]}),e.jsx(de,{open:C,onOpenChange:d,children:e.jsxs(oe,{className:"w-[95vw] max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(me,{children:e.jsx(ue,{children:"Ajouter un suppl√©ment"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"addon-label",children:"Nom du suppl√©ment *"}),e.jsx(F,{id:"addon-label",placeholder:"Ex: Fromage +",value:c.label,onChange:s=>w({...c,label:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"addon-price",children:"Prix (‚Ç¨) *"}),e.jsx(F,{id:"addon-price",type:"number",step:"0.01",min:"0",value:c.price,onChange:s=>w({...c,price:parseFloat(s.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx(E,{children:"S'applique √† *"}),e.jsxs(ge,{value:c.applies_to_type,onValueChange:s=>{w({...c,applies_to_type:s,applies_to_value:s==="global"?"*":""})},children:[e.jsx(fe,{children:e.jsx(ve,{})}),e.jsxs(Ne,{children:[e.jsx(ie,{value:"global",children:"üåç Tous les produits"}),e.jsx(ie,{value:"category",children:"üìÇ Une cat√©gorie"}),e.jsx(ie,{value:"product",children:"üì¶ Un ou des produits sp√©cifiques"})]})]})]}),c.applies_to_type==="category"&&e.jsxs("div",{children:[e.jsx(E,{children:"Cat√©gorie"}),e.jsxs(ge,{value:c.applies_to_value,onValueChange:s=>w({...c,applies_to_value:s}),children:[e.jsx(fe,{children:e.jsx(ve,{placeholder:"Choisir une cat√©gorie"})}),e.jsx(Ne,{children:M.map(s=>e.jsx(ie,{value:s,children:s},s))})]})]}),c.applies_to_type==="product"&&e.jsxs("div",{children:[e.jsx(E,{className:"text-base font-semibold",children:"Produits (s√©lection multiple)"}),e.jsx("div",{className:"border-2 border-border rounded-lg p-4 max-h-60 overflow-y-auto space-y-1 bg-muted/30 mt-2",children:m.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-accent/50 transition-colors",children:[e.jsx(Se,{id:`product-${s.id}`,checked:c.selected_products.includes(s.id),onCheckedChange:v=>{w(k=>({...k,selected_products:v?[...k.selected_products,s.id]:k.selected_products.filter(D=>D!==s.id)}))},className:"h-5 w-5"}),e.jsxs(E,{htmlFor:`product-${s.id}`,className:"cursor-pointer text-sm flex-1 font-medium",children:[s.name," - ",s.unit_price,"‚Ç¨"]})]},s.id))})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"addon-max",children:"Maximum par plat"}),e.jsx(F,{id:"addon-max",type:"number",min:"1",value:c.max_per_item,onChange:s=>w({...c,max_per_item:parseInt(s.target.value)||1})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{checked:c.is_active,onCheckedChange:s=>w({...c,is_active:s})}),e.jsx(E,{children:"Actif"})]})]}),e.jsxs(ke,{children:[e.jsx(f,{variant:"outline",onClick:()=>d(!1),children:"Annuler"}),e.jsx(f,{onClick:R,disabled:!c.label||c.price<=0||c.applies_to_type==="product"&&c.selected_products.length===0,children:"Ajouter"})]})]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(G,{className:"overflow-hidden",children:[e.jsx(Fe,{children:e.jsxs(De,{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("span",{children:["Suppl√©ments (",y.length,")"]}),e.jsxs(f,{onClick:()=>d(!0),className:"w-full sm:w-auto",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"Ajouter"]})]})}),e.jsxs(Y,{className:"px-2 md:px-6",children:[e.jsx("div",{className:"hidden xl:block overflow-x-auto w-full",children:e.jsxs(ls,{className:"w-full table-fixed",children:[e.jsx(ns,{children:e.jsxs(ze,{children:[e.jsx(W,{className:"w-[20%]",children:"Nom"}),e.jsx(W,{className:"w-[10%]",children:"Prix"}),e.jsx(W,{className:"w-[35%]",children:"S'applique √†"}),e.jsx(W,{className:"w-[10%]",children:"Max/plat"}),e.jsx(W,{className:"w-[10%]",children:"Actif"}),e.jsx(W,{className:"w-[15%] text-right",children:"Actions"})]})}),e.jsx(cs,{children:y.map(s=>e.jsxs(ze,{children:[e.jsx(X,{children:e.jsx("span",{className:"font-medium truncate block w-full",title:s.label,children:s.label})}),e.jsx(X,{children:e.jsxs(V,{variant:"secondary",className:"font-mono",children:[s.price?s.price.toFixed(2):"0.00","‚Ç¨"]})}),e.jsx(X,{children:e.jsx("span",{className:"text-sm truncate block w-full",title:J(s),children:J(s)})}),e.jsx(X,{className:"text-center",children:e.jsx(V,{variant:"outline",children:s.max_per_item})}),e.jsx(X,{children:e.jsx(V,{variant:s.is_active?"default":"secondary",children:s.is_active?"Actif":"Inactif"})}),e.jsx(X,{className:"text-right",children:e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>n(s),children:e.jsx(Me,{className:"h-4 w-4"})}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>A(s),disabled:_,children:e.jsx(be,{className:"h-4 w-4 text-destructive"})})]})})]},s.id))})]})}),e.jsx("div",{className:"xl:hidden space-y-3",children:y.map(s=>e.jsx(G,{className:"p-4 w-full",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1 space-y-2",children:[e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:e.jsx("span",{className:"font-medium truncate",children:s.label})}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(V,{variant:s.is_active?"default":"secondary",className:"text-xs",children:s.is_active?"Actif":"Inactif"}),e.jsxs(V,{variant:"secondary",className:"font-mono text-xs",children:[s.price?s.price.toFixed(2):"0.00","‚Ç¨"]}),e.jsxs(V,{variant:"outline",className:"text-xs",children:["Max: ",s.max_per_item]})]}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:J(s)})]}),e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx(f,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>n(s),children:e.jsx(Me,{className:"h-4 w-4"})}),e.jsx(f,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>A(s),disabled:_,children:e.jsx(be,{className:"h-4 w-4 text-destructive"})})]})]})},s.id))})]})]}),e.jsx(de,{open:C,onOpenChange:d,children:e.jsxs(oe,{className:"w-[95vw] max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(me,{children:e.jsx(ue,{children:"Ajouter un suppl√©ment"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"addon-label",children:"Nom du suppl√©ment *"}),e.jsx(F,{id:"addon-label",placeholder:"Ex: Fromage +",value:c.label,onChange:s=>w({...c,label:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"addon-price",children:"Prix (‚Ç¨) *"}),e.jsx(F,{id:"addon-price",type:"number",step:"0.01",min:"0",value:c.price,onChange:s=>w({...c,price:parseFloat(s.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx(E,{children:"S'applique √† *"}),e.jsxs(ge,{value:c.applies_to_type,onValueChange:s=>{w({...c,applies_to_type:s,applies_to_value:s==="global"?"*":""})},children:[e.jsx(fe,{children:e.jsx(ve,{})}),e.jsxs(Ne,{children:[e.jsx(ie,{value:"global",children:"üåç Tous les produits"}),e.jsx(ie,{value:"category",children:"üìÇ Une cat√©gorie"}),e.jsx(ie,{value:"product",children:"üì¶ Un ou des produits sp√©cifiques"})]})]})]}),c.applies_to_type==="category"&&e.jsxs("div",{children:[e.jsx(E,{children:"Cat√©gorie"}),e.jsxs(ge,{value:c.applies_to_value,onValueChange:s=>w({...c,applies_to_value:s}),children:[e.jsx(fe,{children:e.jsx(ve,{placeholder:"Choisir une cat√©gorie"})}),e.jsx(Ne,{children:M.map(s=>e.jsx(ie,{value:s,children:s},s))})]})]}),c.applies_to_type==="product"&&e.jsxs("div",{children:[e.jsx(E,{className:"text-base font-semibold",children:"Produits (s√©lection multiple)"}),e.jsx("div",{className:"border-2 border-border rounded-lg p-4 max-h-60 overflow-y-auto space-y-1 bg-muted/30 mt-2",children:m.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-accent/50 transition-colors",children:[e.jsx(Se,{id:`product-${s.id}`,checked:c.selected_products.includes(s.id),onCheckedChange:v=>{w(k=>({...k,selected_products:v?[...k.selected_products,s.id]:k.selected_products.filter(D=>D!==s.id)}))},className:"h-5 w-5"}),e.jsxs(E,{htmlFor:`product-${s.id}`,className:"cursor-pointer text-sm flex-1 font-medium",children:[s.name," - ",s.unit_price,"‚Ç¨"]})]},s.id))})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"addon-max",children:"Maximum par plat"}),e.jsx(F,{id:"addon-max",type:"number",min:"1",value:c.max_per_item,onChange:s=>w({...c,max_per_item:parseInt(s.target.value)||1})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{checked:c.is_active,onCheckedChange:s=>w({...c,is_active:s})}),e.jsx(E,{children:"Actif"})]})]}),e.jsxs(ke,{children:[e.jsx(f,{variant:"outline",onClick:()=>d(!1),children:"Annuler"}),e.jsx(f,{onClick:R,disabled:!c.label||c.price<=0||c.applies_to_type==="product"&&c.selected_products.length===0,children:"Ajouter"})]})]})}),e.jsx(de,{open:j,onOpenChange:p,children:e.jsxs(oe,{className:"w-[95vw] max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(me,{children:e.jsx(ue,{children:"Modifier le suppl√©ment"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"edit-addon-label",children:"Nom du suppl√©ment *"}),e.jsx(F,{id:"edit-addon-label",placeholder:"Ex: Fromage +",value:N.label,onChange:s=>U({...N,label:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"edit-addon-price",children:"Prix (‚Ç¨) *"}),e.jsx(F,{id:"edit-addon-price",type:"number",step:"0.01",min:"0",value:N.price,onChange:s=>U({...N,price:parseFloat(s.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx(E,{children:"S'applique √† *"}),e.jsxs(ge,{value:N.applies_to_type,onValueChange:s=>{U({...N,applies_to_type:s,applies_to_value:s==="global"?"*":""})},children:[e.jsx(fe,{children:e.jsx(ve,{})}),e.jsxs(Ne,{children:[e.jsx(ie,{value:"global",children:"üåç Tous les produits"}),e.jsx(ie,{value:"category",children:"üìÇ Une cat√©gorie"}),e.jsx(ie,{value:"product",children:"üì¶ Un ou des produits sp√©cifiques"})]})]})]}),N.applies_to_type==="category"&&e.jsxs("div",{children:[e.jsx(E,{children:"Cat√©gorie"}),e.jsxs(ge,{value:N.applies_to_value,onValueChange:s=>U({...N,applies_to_value:s}),children:[e.jsx(fe,{children:e.jsx(ve,{placeholder:"Choisir une cat√©gorie"})}),e.jsx(Ne,{children:M.map(s=>e.jsx(ie,{value:s,children:s},s))})]})]}),N.applies_to_type==="product"&&e.jsxs("div",{children:[e.jsx(E,{className:"text-base font-semibold",children:"Produits (s√©lection multiple)"}),e.jsx("div",{className:"border-2 border-border rounded-lg p-4 max-h-60 overflow-y-auto space-y-1 bg-muted/30 mt-2",children:m.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-accent/50 transition-colors",children:[e.jsx(Se,{id:`edit-product-${s.id}`,checked:N.selected_products.includes(s.id),onCheckedChange:v=>{U(k=>({...k,selected_products:v?[...k.selected_products,s.id]:k.selected_products.filter(D=>D!==s.id)}))},className:"h-5 w-5"}),e.jsxs(E,{htmlFor:`edit-product-${s.id}`,className:"cursor-pointer text-sm flex-1 font-medium",children:[s.name," - ",s.unit_price,"‚Ç¨"]})]},s.id))})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"edit-addon-max",children:"Maximum par plat"}),e.jsx(F,{id:"edit-addon-max",type:"number",min:"1",value:N.max_per_item,onChange:s=>U({...N,max_per_item:parseInt(s.target.value)||1})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{checked:N.is_active,onCheckedChange:s=>U({...N,is_active:s})}),e.jsx(E,{children:"Actif"})]})]}),e.jsxs(ke,{children:[e.jsx(f,{variant:"outline",onClick:()=>p(!1),children:"Annuler"}),e.jsx(f,{onClick:S,disabled:u||!N.label||N.price<=0||N.applies_to_type==="product"&&N.selected_products.length===0,children:u?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"mr-2 h-4 w-4 animate-spin"}),"Sauvegarde..."]}):"Enregistrer les modifications"})]})]})}),e.jsx(Os,{open:T.open,onOpenChange:s=>$({...T,open:s}),title:"Supprimer ce suppl√©ment ?",description:`√ätes-vous s√ªr de vouloir supprimer "${(i=T.addon)==null?void 0:i.label}" ? Cette action est irr√©versible.`,onConfirm:Q})]}):e.jsx(G,{className:"border-dashed",children:e.jsx(Y,{className:"pt-6",children:e.jsxs(ye,{children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsx(qe,{children:"Suppl√©ments non configur√©s"}),e.jsx(we,{children:"Les suppl√©ments ne sont pas encore disponibles pour votre compte. Veuillez recr√©er votre catalogue avec la nouvelle version pour activer cette fonctionnalit√©."})]})})})}const Us=a=>{const o=os(),{profile:l}=ms(),r=(a==null?void 0:a.userId)??(l==null?void 0:l.user_id),{data:h,isLoading:u,error:b}=Ts({queryKey:["menus",r],queryFn:async()=>{if(!r)return[];const{data:d,error:j}=await _e.from("chatbot_menus").select("*").eq("user_id",r).order("label");if(j)throw console.error("Error fetching menus:",j),j;return(d||[]).map(p=>({id:p.id,label:p.label,choice1_label:p.choice1_label||null,choice1_productid:p.choice1_productid||[],choice2_label:p.choice2_label||null,choice2_productid:p.choice2_productid||[],choice3_label:p.choice3_label||null,choice3_productid:p.choice3_productid||[],choice4_label:p.choice4_label||null,choice4_productid:p.choice4_productid||[],menu_price:p.menu_price,days:p.available_days||"",start_time:p.start_time||"",end_time:p.end_time||"",is_active:p.is_active}))},enabled:!!r}),_=Ce({mutationFn:async d=>{if(!r)throw new Error("Utilisateur non connect√©");for(const j of d)await y(j,r)},onSuccess:()=>{ee.success("Menus enregistr√©s"),o.invalidateQueries({queryKey:["menus",r]})},onError:d=>{ee.error(`Erreur: ${d.message}`)}}),m=Ce({mutationFn:async d=>{if(!r)throw new Error("Utilisateur non connect√©");await y(d,r)},onSuccess:()=>{ee.success("Menu enregistr√©"),o.invalidateQueries({queryKey:["menus",r]})},onError:d=>{ee.error(`Erreur: ${d.message}`)}}),y=async(d,j)=>{const{error:p}=await _e.from("chatbot_menus").upsert({id:d.id,user_id:j,label:d.label,choice1_label:d.choice1_label,choice1_productid:d.choice1_productid,choice2_label:d.choice2_label,choice2_productid:d.choice2_productid,choice3_label:d.choice3_label,choice3_productid:d.choice3_productid,choice4_label:d.choice4_label,choice4_productid:d.choice4_productid,menu_price:d.menu_price,available_days:d.days,start_time:d.start_time||null,end_time:d.end_time||null,is_active:d.is_active,updated_at:new Date().toISOString()},{onConflict:"id"});if(p)throw p},x=Ce({mutationFn:async d=>{if(!r||!d.id)throw new Error("Utilisateur non connect√©");const{error:j}=await _e.from("chatbot_menus").delete().eq("id",d.id).eq("user_id",r);if(j)throw j},onSuccess:()=>{ee.success("Menu supprim√©"),o.invalidateQueries({queryKey:["menus",r]})},onError:d=>{ee.error(`Erreur: ${d.message}`)}}),C=Ce({mutationFn:async d=>{if(!r)throw new Error("Utilisateur non connect√©");const{data:j,error:p}=await _e.from("chatbot_menus").select("*").eq("user_id",r).eq("id",d).single();if(p)throw p;return{id:j.id,label:j.label,choice1_label:j.choice1_label||null,choice1_productid:j.choice1_productid||[],choice2_label:j.choice2_label||null,choice2_productid:j.choice2_productid||[],choice3_label:j.choice3_label||null,choice3_productid:j.choice3_productid||[],choice4_label:j.choice4_label||null,choice4_productid:j.choice4_productid||[],menu_price:j.menu_price,days:j.available_days||"",start_time:j.start_time||"",end_time:j.end_time||"",is_active:j.is_active}}});return{menus:h||[],isLoading:u,error:b,hasConfig:!!r,saveMenus:_.mutate,saveMenu:m.mutate,isSaving:_.isPending||m.isPending,deleteMenu:x.mutate,isDeleting:x.isPending,lookupMenu:C.mutateAsync,isLookingUp:C.isPending}};function Xa({open:a,onOpenChange:o,onAdd:l}){const[r,h]=g.useState(""),[u,b]=g.useState(""),_=()=>{if(!r||!u)return;const m={product_id:`TEMP-${Date.now()}`,is_temporary:!0,name:r,price:parseFloat(u)};l(m),h(""),b(""),o(!1)};return e.jsx(de,{open:a,onOpenChange:o,children:e.jsxs(oe,{children:[e.jsxs(me,{children:[e.jsx(ue,{children:"Ajouter un produit temporaire"}),e.jsx(We,{children:"Ajoutez un produit sp√©cial qui n'existe pas dans votre catalogue"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"temp-name",children:"Nom du produit"}),e.jsx(F,{id:"temp-name",value:r,onChange:m=>h(m.target.value),placeholder:"Ex: Plat du chef sp√©cial"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"temp-price",children:"Prix (‚Ç¨)"}),e.jsx(F,{id:"temp-price",type:"number",step:"0.01",min:"0",value:u,onChange:m=>b(m.target.value),placeholder:"14.90"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(f,{variant:"outline",onClick:()=>o(!1),children:"Annuler"}),e.jsx(f,{onClick:_,disabled:!r||!u,children:"Ajouter"})]})]})]})})}const Cs=["lundi","mardi","mercredi","jeudi","vendredi","samedi","dimanche"],ei={lundi:"Lun",mardi:"Mar",mercredi:"Mer",jeudi:"Jeu",vendredi:"Ven",samedi:"Sam",dimanche:"Dim"};function si({open:a,onOpenChange:o,formData:l,setFormData:r,catalogItems:h,onSave:u}){const[b,_]=g.useState(!1),[m,y]=g.useState(""),[x,C]=g.useState([]),[d,j]=g.useState(null),[p,P]=g.useState(null),O=g.useMemo(()=>{const i={};return h.forEach(s=>{const v=s.category||"Autres";i[v]||(i[v]=[]),i[v].push(s)}),i},[h]),T=g.useMemo(()=>{if(!m.trim())return O;const i=m.toLowerCase(),s={};return Object.entries(O).forEach(([v,k])=>{const D=k.filter(B=>B.name.toLowerCase().includes(i)||v.toLowerCase().includes(i));D.length>0&&(s[v]=D)}),s},[O,m]),$=Object.keys(T),c=(l.temporary_products||[]).filter(i=>!i.is_temporary).length,w=(l.temporary_products||[]).filter(i=>i.is_temporary).length,N=(i,s,v)=>{const k=l.daily_schedules.map(D=>D.day===i&&D.slot===s?{...D,enabled:v}:D);r({...l,daily_schedules:k})},U=(i,s,v,k)=>{const D=l.daily_schedules.map(B=>B.day===i&&B.slot===s?{...B,[v]:k}:B);r({...l,daily_schedules:D})},M=(i,s)=>{const v=s?[...l.temporary_products||[],{product_id:i,is_temporary:!1}]:(l.temporary_products||[]).filter(k=>k.product_id!==i);r({...l,temporary_products:v})},R=i=>{r({...l,temporary_products:[...l.temporary_products||[],i]})},n=i=>{r({...l,temporary_products:(l.temporary_products||[]).filter(s=>s.product_id!==i)})},S=i=>{C(s=>s.includes(i)?s.filter(v=>v!==i):[...s,i])},A=i=>(l.temporary_products||[]).some(s=>s.product_id===i),Q=i=>{const s=l.daily_schedules.find(k=>k.slot===i&&k.enabled);if(!s)return;const v=l.daily_schedules.map(k=>k.slot===i?{...k,enabled:!0,start_time:s.start_time,end_time:s.end_time}:k);r({...l,daily_schedules:v})},J=i=>l.daily_schedules.filter(s=>s.day===i&&s.enabled);return e.jsxs(e.Fragment,{children:[e.jsx(de,{open:a,onOpenChange:o,children:e.jsxs(oe,{className:"w-[95vw] max-w-3xl max-h-[90vh] p-0 flex flex-col overflow-hidden",children:[e.jsxs(me,{className:"flex-shrink-0 px-4 sm:px-6 pt-4 sm:pt-6 pb-3 sm:pb-4 border-b",children:[e.jsx(ue,{className:"text-lg sm:text-xl",children:"Configurer le menu du jour"}),e.jsx(We,{className:"text-sm",children:"D√©finissez les horaires et la composition de votre menu du jour"})]}),e.jsx(Xe,{className:"flex-1 px-4 sm:px-6",children:e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"daily-menu-label",children:"Nom du menu"}),e.jsx(F,{id:"daily-menu-label",value:l.label,onChange:i=>r({...l,label:i.target.value}),placeholder:"Menu du jour"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"daily-menu-price",children:"Prix (‚Ç¨)"}),e.jsx(F,{id:"daily-menu-price",type:"number",step:"0.01",min:"0",value:l.menu_price,onChange:i=>r({...l,menu_price:i.target.value}),placeholder:"12.90"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{className:"text-base font-semibold",children:"Horaires d'activation"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{type:"button",variant:"outline",size:"sm",onClick:()=>Q("midi"),className:"text-xs h-7",children:"Midi ‚Üí tous"}),e.jsx(f,{type:"button",variant:"outline",size:"sm",onClick:()=>Q("soir"),className:"text-xs h-7",children:"Soir ‚Üí tous"})]})]}),e.jsxs("div",{className:"block sm:hidden",children:[e.jsx("div",{className:"flex gap-1 overflow-x-auto pb-2 mb-3",children:Cs.map(i=>{const s=J(i);return e.jsxs(f,{type:"button",variant:d===i?"default":"outline",size:"sm",onClick:()=>j(d===i?null:i),className:"relative shrink-0 min-w-[50px]",children:[ei[i],s.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-primary rounded-full"})]},i)})}),d&&e.jsx(G,{children:e.jsxs(Y,{className:"p-3 space-y-3",children:[e.jsxs("div",{className:"font-medium capitalize flex items-center gap-2",children:[e.jsx(Da,{className:"w-4 h-4"}),d]}),["midi","soir"].map(i=>{const s=l.daily_schedules.find(v=>v.day===d&&v.slot===i);return s?e.jsxs("div",{className:"space-y-2 p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Se,{checked:s.enabled,onCheckedChange:v=>N(d,i,v)}),e.jsx("span",{className:"text-sm font-medium capitalize",children:i})]}),s.enabled&&e.jsxs("div",{className:"flex items-center gap-2 ml-6",children:[e.jsx(F,{type:"time",value:s.start_time,onChange:v=>U(d,i,"start_time",v.target.value),className:"flex-1"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"√†"}),e.jsx(F,{type:"time",value:s.end_time,onChange:v=>U(d,i,"end_time",v.target.value),className:"flex-1"})]})]},i):null})]})})]}),e.jsx("div",{className:"hidden sm:block",children:e.jsx("div",{className:"space-y-2",children:Cs.map(i=>{const s=l.daily_schedules.filter(v=>v.day===i);return s.filter(v=>v.enabled),e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:[e.jsx("div",{className:"w-24 font-medium capitalize",children:i}),e.jsx("div",{className:"flex-1 flex gap-2",children:["midi","soir"].map(v=>{const k=s.find(D=>D.slot===v);return k?e.jsxs(za,{open:(p==null?void 0:p.day)===i&&(p==null?void 0:p.slot)===v,onOpenChange:D=>{P(D?{day:i,slot:v}:null)},children:[e.jsx(Ma,{asChild:!0,children:e.jsxs(f,{type:"button",variant:k.enabled?"default":"outline",size:"sm",className:xe("min-w-[140px] justify-start gap-2",k.enabled&&"bg-primary hover:bg-primary/90"),children:[e.jsx(Se,{checked:k.enabled,onCheckedChange:D=>{N(i,v,D)},onClick:D=>D.stopPropagation(),className:xe("border-current",k.enabled&&"border-primary-foreground data-[state=checked]:bg-primary-foreground data-[state=checked]:text-primary")}),e.jsx("span",{className:"capitalize",children:v}),k.enabled&&e.jsxs("span",{className:"text-xs opacity-80",children:[k.start_time,"-",k.end_time]})]})}),e.jsx(Fa,{className:"w-64 p-3",align:"start",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium capitalize",children:[i," - ",v]}),e.jsx(Se,{checked:k.enabled,onCheckedChange:D=>N(i,v,D)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{className:"text-xs",children:"Horaires"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{type:"time",value:k.start_time,onChange:D=>U(i,v,"start_time",D.target.value),className:"flex-1"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"√†"}),e.jsx(F,{type:"time",value:k.end_time,onChange:D=>U(i,v,"end_time",D.target.value),className:"flex-1"})]})]})]})})]},v):null})})]},i)})})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[e.jsx(E,{className:"text-base font-semibold",children:"Composition du menu"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(V,{variant:"secondary",className:"shrink-0",children:[c," produit",c>1?"s":""]}),w>0&&e.jsxs(V,{variant:"outline",className:"shrink-0",children:["+",w," sp√©cial",w>1?"s":""]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Je,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(F,{placeholder:"Rechercher un produit...",value:m,onChange:i=>y(i.target.value),className:"pl-9"}),m&&e.jsx(f,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 p-0",onClick:()=>y(""),children:e.jsx($e,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-1",children:$.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"Aucun produit trouv√©"}):$.map(i=>e.jsx(Is,{open:x.includes(i),onOpenChange:()=>S(i),children:e.jsxs(G,{className:"overflow-hidden",children:[e.jsx(Ps,{className:"w-full",children:e.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xs,{className:xe("w-4 h-4 transition-transform",x.includes(i)&&"rotate-180")}),e.jsx("span",{className:"font-medium",children:i}),e.jsx(V,{variant:"outline",className:"text-xs",children:T[i].length})]}),(()=>{const s=T[i].filter(v=>A(v.id)).length;return s>0?e.jsxs(V,{className:"text-xs",children:[s," s√©lectionn√©",s>1?"s":""]}):null})()]})}),e.jsx(Es,{children:e.jsx("div",{className:"border-t p-2 grid grid-cols-1 sm:grid-cols-2 gap-2",children:T[i].map(s=>{var k;const v=A(s.id);return e.jsxs("div",{onClick:()=>M(s.id,!v),className:xe("flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all",v?"bg-primary/10 border-2 border-primary/50":"bg-muted/30 border-2 border-transparent hover:bg-muted/50"),children:[e.jsx("div",{className:xe("w-5 h-5 rounded-full border-2 flex items-center justify-center shrink-0 transition-colors",v?"bg-primary border-primary text-primary-foreground":"border-muted-foreground/30"),children:v&&e.jsx(Ee,{className:"w-3 h-3"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:s.name}),s.description&&e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:s.description})]}),e.jsxs("div",{className:"text-sm font-semibold text-primary shrink-0",children:[(k=s.unit_price)==null?void 0:k.toFixed(2),"‚Ç¨"]})]},s.id)})})})]})},i))}),e.jsxs(f,{type:"button",variant:"outline",onClick:()=>_(!0),className:"w-full",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Ajouter un produit sp√©cial"]}),w>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{className:"text-sm",children:"Produits sp√©ciaux"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:(l.temporary_products||[]).filter(i=>i.is_temporary).map(i=>{var s;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-accent/10 border border-accent/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(Ue,{className:"w-4 h-4 text-accent shrink-0"}),e.jsx("span",{className:"text-sm font-medium truncate",children:i.name}),e.jsxs("span",{className:"text-sm text-muted-foreground shrink-0",children:[(s=i.price)==null?void 0:s.toFixed(2),"‚Ç¨"]})]}),e.jsx(f,{type:"button",variant:"ghost",size:"sm",onClick:()=>n(i.product_id),className:"h-7 w-7 p-0 shrink-0",children:e.jsx($e,{className:"w-4 h-4"})})]},i.product_id)})})]})]})]})}),e.jsxs(ke,{className:"flex-shrink-0 px-4 sm:px-6 pb-4 sm:pb-6 pt-3 sm:pt-4 border-t gap-2",children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Annuler"}),e.jsx(f,{type:"button",onClick:u,children:"Enregistrer"})]})]})}),e.jsx(Xa,{open:b,onOpenChange:_,onAdd:R})]})}const Ss={lun:"Lundi",mar:"Mardi",mer:"Mercredi",jeu:"Jeudi",ven:"Vendredi",sam:"Samedi",dim:"Dimanche"},Ge=a=>{if(!a)return"";const o=a.split(":");return o.length>=2?`${o[0]}:${o[1]}`:a},ai=["lundi","mardi","mercredi","jeudi","vendredi","samedi","dimanche"],ii=["midi","soir"];function ri(a){const o=[];return(a.choice1_label||a.choice1_productid&&a.choice1_productid.length>0)&&o.push({label:a.choice1_label||"",productIds:a.choice1_productid||[]}),(a.choice2_label||a.choice2_productid&&a.choice2_productid.length>0)&&o.push({label:a.choice2_label||"",productIds:a.choice2_productid||[]}),(a.choice3_label||a.choice3_productid&&a.choice3_productid.length>0)&&o.push({label:a.choice3_label||"",productIds:a.choice3_productid||[]}),(a.choice4_label||a.choice4_productid&&a.choice4_productid.length>0)&&o.push({label:a.choice4_label||"",productIds:a.choice4_productid||[]}),{label:a.label||"",choices:o,menu_price:(a.menu_price??0).toString(),days:(a.days||"").split(",").filter(Boolean),start_time:a.start_time||"11:30",end_time:a.end_time||"14:30",is_active:a.is_active??!0,is_daily_menu:!1,daily_schedules:ps(),temporary_products:[]}}function As(a,o){var l,r,h,u,b,_,m,y;return{id:(o==null?void 0:o.id)||crypto.randomUUID(),label:a.label.trim(),choice1_label:((l=a.choices[0])==null?void 0:l.label)||null,choice1_productid:((r=a.choices[0])==null?void 0:r.productIds)||[],choice2_label:((h=a.choices[1])==null?void 0:h.label)||null,choice2_productid:((u=a.choices[1])==null?void 0:u.productIds)||[],choice3_label:((b=a.choices[2])==null?void 0:b.label)||null,choice3_productid:((_=a.choices[2])==null?void 0:_.productIds)||[],choice4_label:((m=a.choices[3])==null?void 0:m.label)||null,choice4_productid:((y=a.choices[3])==null?void 0:y.productIds)||[],menu_price:parseFloat(a.menu_price)||0,days:a.days.join(","),start_time:a.start_time,end_time:a.end_time,is_active:a.is_active}}const ps=()=>{const a=[];return ai.forEach(o=>{ii.forEach(l=>{a.push({day:o,slot:l,start_time:l==="midi"?"11:30":"18:30",end_time:l==="midi"?"14:30":"22:00",enabled:!1})})}),a},Qe={label:"",choices:[],menu_price:"",days:[],start_time:"11:30",end_time:"14:30",is_active:!0,is_daily_menu:!1,daily_schedules:ps(),temporary_products:[]};function ti({userId:a,catalogItems:o}){var Ns;const{menus:l,isLoading:r,hasConfig:h,saveMenu:u,isSaving:b,deleteMenu:_,isDeleting:m,lookupMenu:y,isLookingUp:x}=Us({userId:a}),{settings:C,updateSettings:d}=es(a),{canAccessDailyMenu:j}=zs(),[p,P]=g.useState([]),[O,T]=g.useState(!1),[$,c]=g.useState(!1),[w,N]=g.useState(!1),[U,M]=g.useState(null),[R,n]=g.useState({open:!1,menu:null}),[S,A]=g.useState(0),[Q,J]=g.useState({...Qe}),[i,s]=g.useState(0),[v,k]=g.useState({...Qe}),[D,B]=g.useState(!1),[se,He]=g.useState({...Qe,is_daily_menu:!0,label:"Menu du jour"});g.useEffect(()=>{P(l)},[l]),g.useEffect(()=>{if(C&&(B(C.daily_menu_enabled??!1),C.daily_menu_config)){const t=C.daily_menu_config;He(H=>({...H,label:t.menu_label||"Menu du jour",menu_price:(t.menu_price??0).toString(),daily_schedules:t.schedules||ps(),temporary_products:t.products||[],is_daily_menu:!0}))}},[C]);const te=()=>{const t=As(Q);P([...p,t]),u(t),T(!1),J({...Qe})},Te=async t=>{M(t);try{const H=await y(t.id);k(ri(H)),s(0),N(!0)}catch(H){console.error("Erreur lookup menu:",H)}},is=()=>{if(!U)return;const t=As(v,U);P(H=>H.map(Z=>Z.id===t.id?t:Z)),u(t),N(!1),M(null)},Oe=t=>{n({open:!0,menu:t})},I=()=>{R.menu&&(P(t=>t.filter(H=>H.id!==R.menu.id)),_(R.menu),n({open:!1,menu:null}))},L=()=>{d({daily_menu_enabled:D,daily_menu_config:{menu_label:se.label,menu_price:parseFloat(se.menu_price)||0,schedules:se.daily_schedules,products:se.temporary_products}}),c(!1)},z=t=>t?t.split(",").map(Z=>Ss[Z]||Z).join(", "):"",K=(t,H=!1)=>{H?k(Z=>({...Z,days:Z.days.includes(t)?Z.days.filter(Ae=>Ae!==t):[...Z.days,t]})):J(Z=>({...Z,days:Z.days.includes(t)?Z.days.filter(Ae=>Ae!==t):[...Z.days,t]}))},Ie=(t,H,Z,Ae,_s=!1)=>e.jsxs("div",{className:"space-y-4 pb-4",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"menu-label",children:"Nom du menu / formule *"}),e.jsx(F,{id:"menu-label",placeholder:"Ex: Menu du midi, Formule Burger...",value:t.label,onChange:q=>H({...t,label:q.target.value})})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"menu-price",children:"Prix du menu *"}),e.jsx(F,{id:"menu-price",type:"number",step:"0.01",min:"0",placeholder:"12.00",value:t.menu_price,onChange:q=>H({...t,menu_price:q.target.value})})]}),e.jsxs("div",{children:[e.jsx(E,{children:"Composition du menu *"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Cr√©ez jusqu'√† 4 groupes de choix pour votre menu (ex: Pizza + Boisson + Dessert)"}),e.jsx("div",{className:"space-y-3",children:t.choices.map((q,re)=>e.jsx(Is,{open:Z===re,onOpenChange:ae=>{ae&&Ae(re)},children:e.jsx(G,{className:`border-2 transition-all duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] overflow-hidden ${Z===re?"border-primary":"border-primary/20"}`,children:e.jsxs(Y,{className:"p-3 sm:p-4 space-y-3 overflow-hidden",children:[e.jsx(Ps,{className:"w-full",children:e.jsxs("div",{className:"flex items-center gap-2 w-full overflow-hidden",children:[e.jsxs(V,{variant:"outline",className:"shrink-0",children:["Choix ",re+1]}),e.jsx("div",{className:"flex-1 text-left min-w-0 overflow-hidden",children:q.label?e.jsxs("span",{className:"text-sm font-medium",children:[q.label,q.productIds.length>0&&e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",q.productIds.length," produit",q.productIds.length>1?"s":"",")"]})]}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"Sans titre"})}),e.jsx(xs,{className:`h-4 w-4 transition-transform duration-500 ease-[cubic-bezier(0.4,0,0.2,1)] ${Z===re?"rotate-180":""}`}),e.jsx(f,{variant:"ghost",size:"icon",onClick:ae=>{ae.stopPropagation();const je=t.choices.filter((Ke,rs)=>rs!==re);H({...t,choices:je}),Z===re&&Ae(je.length>0?0:null)},children:e.jsx(be,{className:"h-4 w-4 text-destructive"})})]})}),e.jsx(Es,{className:"overflow-hidden transition-all duration-500 ease-[cubic-bezier(0.4,0,0.2,1)]",children:e.jsxs("div",{className:"space-y-3 pt-3",children:[e.jsx(F,{placeholder:"Ex: Pizza au choix, Boisson au choix...",value:q.label,onChange:ae=>{const je=[...t.choices];je[re].label=ae.target.value,H({...t,choices:je})}}),e.jsx(Xe,{className:"h-64",children:e.jsx("div",{className:"space-y-2 pr-4",children:o.length>0?o.map(ae=>e.jsx(G,{className:"border-2 hover:border-primary/50 transition-colors cursor-pointer overflow-hidden",children:e.jsx(Y,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 w-full overflow-hidden",children:[e.jsx(Se,{id:`choice-${re}-${ae.id}`,checked:q.productIds.includes(ae.id),onCheckedChange:()=>{const je=[...t.choices],Ke=je[re].productIds;je[re].productIds=Ke.includes(ae.id)?Ke.filter(rs=>rs!==ae.id):[...Ke,ae.id],H({...t,choices:je})},className:"shrink-0"}),e.jsxs(E,{htmlFor:`choice-${re}-${ae.id}`,className:"cursor-pointer flex-1 min-w-0 flex flex-col sm:flex-row sm:items-center justify-between gap-1 sm:gap-2 overflow-hidden",children:[e.jsx("span",{className:"font-medium truncate min-w-0",children:ae.name}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 shrink-0",children:[e.jsxs(V,{variant:"secondary",className:"font-mono text-xs",children:[ae.unit_price,"‚Ç¨"]}),e.jsx(V,{variant:"outline",className:"text-xs truncate max-w-[80px] sm:max-w-[100px]",children:ae.category})]})]})]})})},ae.id)):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Aucun produit disponible"})})})]})})]})})},re))}),t.choices.length<4&&e.jsxs(f,{variant:"outline",className:"w-full border-dashed border-2 mt-3",onClick:()=>{const q=t.choices.length;H({...t,choices:[...t.choices,{label:"",productIds:[]}]}),Ae(q)},children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"Ajouter un choix (",t.choices.length,"/4)"]})]}),e.jsxs("div",{className:"w-full overflow-hidden",children:[e.jsx(E,{className:"mb-3 block",children:"Jours de disponibilit√© *"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 w-full",children:Object.entries(Ss).map(([q,re])=>e.jsx(G,{className:`border-2 cursor-pointer transition-all min-w-0 ${t.days.includes(q)?"border-primary bg-primary/10":"border-border hover:border-primary/50"}`,onClick:()=>K(q,_s),children:e.jsxs(Y,{className:"p-2 sm:p-3 flex items-center gap-2",children:[e.jsx(Se,{id:`day-${q}`,checked:t.days.includes(q),onCheckedChange:()=>K(q,_s),className:"shrink-0"}),e.jsx(E,{htmlFor:`day-${q}`,className:"cursor-pointer flex-1 font-medium text-xs sm:text-sm truncate min-w-0",children:re})]})},q))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"start-time",children:"Heure de d√©but *"}),e.jsx(F,{id:"start-time",type:"time",value:t.start_time,onChange:q=>H({...t,start_time:q.target.value})})]}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"end-time",children:"Heure de fin *"}),e.jsx(F,{id:"end-time",type:"time",value:t.end_time,onChange:q=>H({...t,end_time:q.target.value})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{checked:t.is_active,onCheckedChange:q=>H({...t,is_active:q})}),e.jsx(E,{children:"Menu actif"})]})]}),vs=t=>t.label&&t.choices.length>0&&t.choices.every(H=>H.label&&H.productIds.length>0)&&t.menu_price&&t.days.length>0;return h?r?e.jsx(G,{children:e.jsx(Y,{className:"flex items-center justify-center py-12",children:e.jsx(ne,{className:"h-8 w-8 animate-spin text-muted-foreground"})})}):e.jsxs("div",{className:"space-y-6",children:[j&&e.jsxs(G,{children:[e.jsxs(Fe,{className:"px-4 md:px-6",children:[e.jsxs(De,{className:"flex items-center gap-2 text-base md:text-lg",children:[e.jsx(Ta,{className:"w-4 h-4 md:w-5 md:h-5"}),"Menu du jour"]}),e.jsx(us,{className:"text-xs md:text-sm",children:"Proposez un menu sp√©cial √† des horaires d√©finis"})]}),e.jsxs(Y,{className:"space-y-4 px-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(E,{className:"text-sm md:text-base",children:"Activer le menu du jour"}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground",children:"Le chatbot proposera ce menu aux horaires configur√©s"})]}),e.jsx(pe,{checked:D,onCheckedChange:t=>{B(t),d({daily_menu_enabled:t})}})]}),D&&e.jsx("div",{className:"pt-2 space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:se.label}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[parseFloat(se.menu_price||"0").toFixed(2),"‚Ç¨ ‚Ä¢ ",se.daily_schedules.filter(t=>t.enabled).length," cr√©neaux actifs"]})]}),e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>c(!0),children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"Configurer"]})]})})]})]}),e.jsxs(G,{className:"w-full max-w-full min-w-0 overflow-hidden",children:[e.jsx(Fe,{className:"px-4 md:px-6 min-w-0",children:e.jsxs(De,{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 min-w-0",children:[e.jsxs("span",{className:"truncate min-w-0",children:["Menus & Formules (",p.length,")"]}),e.jsxs(f,{onClick:()=>T(!0),className:"w-full sm:w-auto shrink-0",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"Ajouter"]})]})}),e.jsx(Y,{className:"px-2 md:px-6 w-full max-w-full min-w-0 overflow-hidden",children:p.length===0?e.jsxs(ye,{children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsx(qe,{children:"Aucun menu d√©fini"}),e.jsx(we,{children:"Cr√©ez des menus avec des cr√©neaux horaires pour proposer des formules √† vos clients (ex : Menu du midi disponible du lundi au vendredi de 11h30 √† 14h30)"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden xl:block overflow-x-auto w-full max-w-full min-w-0",children:e.jsxs(ls,{className:"w-full table-fixed min-w-0",children:[e.jsx(ns,{children:e.jsxs(ze,{children:[e.jsx(W,{className:"w-[20%]",children:"Nom"}),e.jsx(W,{className:"w-[10%]",children:"Prix"}),e.jsx(W,{className:"w-[25%]",children:"Disponibilit√©"}),e.jsx(W,{className:"w-[20%]",children:"Horaires"}),e.jsx(W,{className:"w-[10%]",children:"Actif"}),e.jsx(W,{className:"w-[15%] text-right",children:"Actions"})]})}),e.jsx(cs,{children:p.map(t=>e.jsxs(ze,{children:[e.jsx(X,{children:e.jsx("span",{className:"font-medium truncate block w-full",title:t.label,children:t.label})}),e.jsx(X,{children:e.jsxs(V,{variant:"secondary",className:"font-mono",children:[t.menu_price?t.menu_price.toFixed(2):"0.00","‚Ç¨"]})}),e.jsx(X,{children:e.jsx("span",{className:"text-sm truncate block w-full",title:z(t.days),children:z(t.days)})}),e.jsx(X,{children:e.jsxs("span",{className:"text-sm font-mono whitespace-nowrap",children:[t.start_time," ‚Üí ",t.end_time]})}),e.jsx(X,{children:e.jsx(V,{variant:t.is_active?"default":"secondary",children:t.is_active?"Actif":"Inactif"})}),e.jsx(X,{className:"text-right",children:e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>Te(t),disabled:x,children:x?e.jsx(ne,{className:"h-4 w-4 animate-spin"}):e.jsx(Me,{className:"h-4 w-4"})}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>Oe(t),disabled:m,children:e.jsx(be,{className:"h-4 w-4 text-destructive"})})]})})]},t.id))})]})}),e.jsx("div",{className:"hidden md:block xl:hidden overflow-x-auto w-full max-w-full min-w-0",children:e.jsxs(ls,{className:"w-full min-w-0",children:[e.jsx(ns,{children:e.jsxs(ze,{children:[e.jsx(W,{className:"w-[30%]",children:"Nom"}),e.jsx(W,{className:"w-[15%]",children:"Prix"}),e.jsx(W,{className:"w-[25%]",children:"Horaires"}),e.jsx(W,{className:"w-[15%]",children:"Actif"}),e.jsx(W,{className:"w-[15%] text-right",children:"Actions"})]})}),e.jsx(cs,{children:p.map(t=>e.jsxs(ze,{children:[e.jsx(X,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"font-medium truncate block",title:t.label,children:t.label}),e.jsx("span",{className:"text-xs text-muted-foreground truncate block",title:z(t.days),children:z(t.days)})]})}),e.jsx(X,{children:e.jsxs(V,{variant:"secondary",className:"font-mono text-xs",children:[t.menu_price?t.menu_price.toFixed(2):"0.00","‚Ç¨"]})}),e.jsx(X,{children:e.jsxs("span",{className:"text-sm font-mono whitespace-nowrap",children:[Ge(t.start_time)," ‚Üí ",Ge(t.end_time)]})}),e.jsx(X,{children:e.jsx(V,{variant:t.is_active?"default":"secondary",className:"text-xs",children:t.is_active?"Actif":"Inactif"})}),e.jsx(X,{className:"text-right",children:e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>Te(t),disabled:x,children:x?e.jsx(ne,{className:"h-4 w-4 animate-spin"}):e.jsx(Me,{className:"h-4 w-4"})}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>Oe(t),disabled:m,children:e.jsx(be,{className:"h-4 w-4 text-destructive"})})]})})]},t.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3 w-full min-w-0 overflow-hidden",children:p.map(t=>e.jsx(G,{className:"p-4 w-full min-w-0 overflow-hidden",children:e.jsxs("div",{className:"flex items-start justify-between gap-2 w-full min-w-0 overflow-hidden",children:[e.jsxs("div",{className:"min-w-0 flex-1 space-y-2 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"font-medium truncate min-w-0 flex-1",children:t.label}),e.jsx(V,{variant:t.is_active?"default":"secondary",className:"text-xs shrink-0",children:t.is_active?"Actif":"Inactif"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap min-w-0",children:[e.jsxs(V,{variant:"secondary",className:"font-mono text-xs shrink-0",children:[t.menu_price?t.menu_price.toFixed(2):"0.00","‚Ç¨"]}),e.jsxs("span",{className:"text-xs font-mono text-muted-foreground",children:[Ge(t.start_time)," ‚Üí ",Ge(t.end_time)]})]}),e.jsx("p",{className:"text-xs text-muted-foreground truncate w-full",children:z(t.days)})]}),e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx(f,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0",onClick:()=>Te(t),disabled:x,children:x?e.jsx(ne,{className:"h-4 w-4 animate-spin"}):e.jsx(Me,{className:"h-4 w-4"})}),e.jsx(f,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0",onClick:()=>Oe(t),disabled:m,children:e.jsx(be,{className:"h-4 w-4 text-destructive"})})]})]})},t.id))})]})})]}),e.jsx(de,{open:O,onOpenChange:T,children:e.jsxs(oe,{className:"w-[95vw] max-w-2xl max-h-[90vh] p-0 flex flex-col overflow-hidden",children:[e.jsx(me,{className:"flex-shrink-0 px-6 pt-6 pb-4",children:e.jsx(ue,{children:"Ajouter un menu / formule"})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6",children:Ie(Q,J,S,A,!1)}),e.jsxs(ke,{className:"flex-shrink-0 px-6 pb-6 pt-4",children:[e.jsx(f,{variant:"outline",onClick:()=>T(!1),children:"Annuler"}),e.jsx(f,{onClick:te,disabled:!vs(Q),children:"Ajouter"})]})]})}),e.jsx(de,{open:w,onOpenChange:N,children:e.jsxs(oe,{className:"w-[95vw] max-w-2xl max-h-[90vh] p-0 flex flex-col overflow-hidden",children:[e.jsx(me,{className:"flex-shrink-0 px-6 pt-6 pb-4",children:e.jsx(ue,{children:"Modifier le menu"})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6",children:Ie(v,k,i,s,!0)}),e.jsxs(ke,{className:"flex-shrink-0 px-6 pb-6 pt-4",children:[e.jsx(f,{variant:"outline",onClick:()=>N(!1),children:"Annuler"}),e.jsx(f,{onClick:is,disabled:b||!vs(v),children:b?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"mr-2 h-4 w-4 animate-spin"}),"Sauvegarde..."]}):"Enregistrer les modifications"})]})]})}),e.jsx(si,{open:$,onOpenChange:c,formData:{label:se.label,menu_price:se.menu_price,daily_schedules:se.daily_schedules,temporary_products:se.temporary_products},setFormData:t=>He({...se,...t}),catalogItems:o,onSave:L}),e.jsx(Os,{open:R.open,onOpenChange:t=>n({...R,open:t}),title:"Supprimer ce menu ?",description:`√ätes-vous s√ªr de vouloir supprimer "${(Ns=R.menu)==null?void 0:Ns.label}" ? Cette action est irr√©versible.`,onConfirm:I})]}):e.jsx(G,{className:"border-dashed",children:e.jsx(Y,{className:"pt-6",children:e.jsxs(ye,{children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsx(qe,{children:"Menus non configur√©s"}),e.jsx(we,{children:"Les menus ne sont pas encore disponibles pour votre compte. Veuillez recr√©er votre catalogue avec la nouvelle version pour activer cette fonctionnalit√©."})]})})})}function li({asset:a,open:o,onOpenChange:l}){const[r,h]=g.useState(100),[u,b]=g.useState(0),_=()=>h(d=>Math.min(d+20,200)),m=()=>h(d=>Math.max(d-20,50)),y=()=>b(d=>(d+90)%360),x=()=>{h(100),b(0)},C=async()=>{if(a)try{const j=await(await fetch(a.url)).blob(),p=window.URL.createObjectURL(j),P=document.createElement("a");P.href=p,P.download=a.filename,document.body.appendChild(P),P.click(),document.body.removeChild(P),window.URL.revokeObjectURL(p)}catch(d){console.error("Erreur t√©l√©chargement:",d)}};return a?e.jsx(de,{open:o,onOpenChange:l,children:e.jsxs(oe,{className:"max-w-[95vw] w-fit max-h-[95vh] p-0 overflow-hidden",children:[e.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between p-4 bg-background border-b",children:[e.jsxs("div",{className:"flex-1 min-w-0 mr-4",children:[e.jsx("h3",{className:"font-semibold truncate",children:a.description}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:a.filename})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(f,{variant:"outline",size:"icon",onClick:m,disabled:r<=50,children:e.jsx(Oa,{className:"h-4 w-4"})}),e.jsxs(f,{variant:"outline",size:"sm",onClick:x,className:"min-w-[80px]",children:[r,"%"]}),e.jsx(f,{variant:"outline",size:"icon",onClick:_,disabled:r>=200,children:e.jsx(Ra,{className:"h-4 w-4"})}),e.jsx("div",{className:"w-px h-6 bg-border mx-1"}),e.jsx(f,{variant:"outline",size:"icon",onClick:y,children:e.jsx(Ua,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"icon",onClick:C,children:e.jsx(La,{className:"h-4 w-4"})}),e.jsx("div",{className:"w-px h-6 bg-border mx-1"}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>l(!1),children:e.jsx($e,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"relative flex items-center justify-center p-4 overflow-auto bg-muted/30",style:{height:"calc(95vh - 80px)"},children:e.jsx("img",{src:a.url,alt:a.description,className:"max-w-full max-h-full object-contain transition-transform duration-200",style:{transform:`scale(${r/100}) rotate(${u}deg)`,transformOrigin:"center center"}})})]})}):null}function ni({asset:a,onRemove:o,onPreview:l}){const{attributes:r,listeners:h,setNodeRef:u,transform:b,transition:_,isDragging:m}=Ia({id:a.id}),y={transform:Pa.Transform.toString(b),transition:_,opacity:m?.5:1};return e.jsx(G,{ref:u,style:y,className:"p-4 h-full flex flex-col",children:e.jsxs("div",{className:"flex flex-col h-full space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{...r,...h,className:"cursor-grab active:cursor-grabbing p-1 hover:bg-muted rounded",children:e.jsx(Ea,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs(V,{variant:"secondary",className:"text-xs",children:["#",a.order+1]})]}),e.jsxs("div",{className:"relative aspect-video rounded overflow-hidden bg-muted group cursor-pointer",onClick:l,children:[e.jsx("img",{src:a.url,alt:a.description,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx($a,{className:"h-8 w-8 text-white"})})]}),e.jsxs("div",{className:"space-y-1 flex-1",children:[e.jsx("p",{className:"font-medium text-sm line-clamp-2",title:a.description,children:a.description}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",title:a.filename,children:a.filename})]}),e.jsxs(f,{variant:"destructive",size:"sm",onClick:o,className:"w-full",children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),"Supprimer"]})]})})}function ci({userId:a,assets:o,onAssetsChange:l}){const[r,h]=g.useState(!1),[u,b]=g.useState(null),[_,m]=g.useState(""),[y,x]=g.useState(null),[C,d]=g.useState(null),[j,p]=g.useState(!1),{uploadAsset:P,deleteAsset:O,uploading:T}=va(a),$=Na(ys(ka),ys(Aa,{coordinateGetter:Sa})),c=n=>{const{active:S,over:A}=n;if(A&&S.id!==A.id){const Q=R.findIndex(s=>s.id===S.id),J=R.findIndex(s=>s.id===A.id),i=Ca(R,Q,J).map((s,v)=>({...s,order:v}));l(i),ia({title:"Ordre modifi√©",description:"L'ordre des assets a √©t√© mis √† jour"})}},w=n=>{var A;const S=(A=n.target.files)==null?void 0:A[0];if(S){b(S);const Q=new FileReader;Q.onloadend=()=>{x(Q.result)},Q.readAsDataURL(S)}},N=async()=>{if(!u||!_.trim())return;const n=await P(u,_);if(n){const S={id:crypto.randomUUID(),url:n.url,description:_.trim(),filename:n.filename,created_at:new Date().toISOString(),order:o.length};l([...o,S]),b(null),m(""),x(null),h(!1)}},U=async n=>{await O(n.url);const S=o.filter(A=>A.id!==n.id).map((A,Q)=>({...A,order:Q}));l(S)},M=n=>{d(n),p(!0)},R=[...o].map((n,S)=>({...n,order:n.order??S})).sort((n,S)=>n.order-S.order);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsx(E,{className:"text-base",children:"Images du restaurant"}),e.jsxs(de,{open:r,onOpenChange:h,children:[e.jsx(aa,{asChild:!0,children:e.jsxs(f,{variant:"default",size:"default",className:"w-full sm:w-auto shadow-md",children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Ajouter une image"]})}),e.jsxs(oe,{children:[e.jsx(me,{children:e.jsx(ue,{children:"Ajouter une nouvelle image"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"description",children:["Description de l'image ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"üí° Vous pouvez indiquer plusieurs cat√©gories dans la m√™me image"}),e.jsx(F,{id:"description",value:_,onChange:n=>m(n.target.value),placeholder:"Ex: Menu entr√©es, pizzas, paninis et desserts"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"file",children:["Image (PNG ou JPG) ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(F,{id:"file",type:"file",accept:"image/png,image/jpeg,image/jpg",onChange:w})]}),y&&e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Aper√ßu :"}),e.jsx("img",{src:y,alt:"Preview",className:"w-full h-48 object-cover rounded"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{onClick:N,disabled:!u||!_.trim()||T,className:"flex-1",children:T?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"h-4 w-4 mr-2 animate-spin"}),"Upload en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Uploader"]})}),e.jsx(f,{variant:"outline",onClick:()=>h(!1),disabled:T,children:"Annuler"})]})]})]})]})]}),e.jsx(_a,{sensors:$,collisionDetection:ba,onDragEnd:c,children:e.jsx(ya,{items:R.map(n=>n.id),strategy:wa,children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 auto-rows-fr",children:R.map(n=>e.jsx(ni,{asset:n,onRemove:()=>U(n),onPreview:()=>M(n)},n.id))})})}),o.length===0&&e.jsx(G,{className:"p-12 col-span-full border-2 border-dashed",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(Rs,{className:"h-16 w-16 mx-auto text-muted-foreground opacity-50"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium",children:"Aucune image pour le moment"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Uploadez des images de votre menu pour enrichir votre catalogue"})]}),e.jsxs(f,{onClick:()=>h(!0),size:"lg",className:"mt-4",children:[e.jsx(ts,{className:"h-5 w-5 mr-2"}),"Ajouter votre premi√®re image"]})]})}),e.jsx(li,{asset:C,open:j,onOpenChange:p})]})}var he="Accordion",di=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[js,oi,mi]=ra(he),[ss]=ta(he,[mi,Fs]),gs=Fs(),Ls=le.forwardRef((a,o)=>{const{type:l,...r}=a,h=r,u=r;return e.jsx(js.Provider,{scope:a.__scopeAccordion,children:l==="multiple"?e.jsx(pi,{...u,ref:o}):e.jsx(xi,{...h,ref:o})})});Ls.displayName=he;var[$s,ui]=ss(he),[qs,hi]=ss(he,{collapsible:!1}),xi=le.forwardRef((a,o)=>{const{value:l,defaultValue:r,onValueChange:h=()=>{},collapsible:u=!1,...b}=a,[_,m]=Ms({prop:l,defaultProp:r??"",onChange:h,caller:he});return e.jsx($s,{scope:a.__scopeAccordion,value:le.useMemo(()=>_?[_]:[],[_]),onItemOpen:m,onItemClose:le.useCallback(()=>u&&m(""),[u,m]),children:e.jsx(qs,{scope:a.__scopeAccordion,collapsible:u,children:e.jsx(Vs,{...b,ref:o})})})}),pi=le.forwardRef((a,o)=>{const{value:l,defaultValue:r,onValueChange:h=()=>{},...u}=a,[b,_]=Ms({prop:l,defaultProp:r??[],onChange:h,caller:he}),m=le.useCallback(x=>_((C=[])=>[...C,x]),[_]),y=le.useCallback(x=>_((C=[])=>C.filter(d=>d!==x)),[_]);return e.jsx($s,{scope:a.__scopeAccordion,value:b,onItemOpen:m,onItemClose:y,children:e.jsx(qs,{scope:a.__scopeAccordion,collapsible:!0,children:e.jsx(Vs,{...u,ref:o})})})}),[ji,as]=ss(he),Vs=le.forwardRef((a,o)=>{const{__scopeAccordion:l,disabled:r,dir:h,orientation:u="vertical",...b}=a,_=le.useRef(null),m=oa(_,o),y=oi(l),C=qa(h)==="ltr",d=ma(a.onKeyDown,j=>{var R;if(!di.includes(j.key))return;const p=j.target,P=y().filter(n=>{var S;return!((S=n.ref.current)!=null&&S.disabled)}),O=P.findIndex(n=>n.ref.current===p),T=P.length;if(O===-1)return;j.preventDefault();let $=O;const c=0,w=T-1,N=()=>{$=O+1,$>w&&($=c)},U=()=>{$=O-1,$<c&&($=w)};switch(j.key){case"Home":$=c;break;case"End":$=w;break;case"ArrowRight":u==="horizontal"&&(C?N():U());break;case"ArrowDown":u==="vertical"&&N();break;case"ArrowLeft":u==="horizontal"&&(C?U():N());break;case"ArrowUp":u==="vertical"&&U();break}const M=$%T;(R=P[M].ref.current)==null||R.focus()});return e.jsx(ji,{scope:l,disabled:r,direction:h,orientation:u,children:e.jsx(js.Slot,{scope:l,children:e.jsx(Ds.div,{...b,"data-orientation":u,ref:m,onKeyDown:r?void 0:d})})})}),Ye="AccordionItem",[gi,fs]=ss(Ye),Hs=le.forwardRef((a,o)=>{const{__scopeAccordion:l,value:r,...h}=a,u=as(Ye,l),b=ui(Ye,l),_=gs(l),m=la(),y=r&&b.value.includes(r)||!1,x=u.disabled||a.disabled;return e.jsx(gi,{scope:l,open:y,disabled:x,triggerId:m,children:e.jsx(na,{"data-orientation":u.orientation,"data-state":Js(y),..._,...h,ref:o,disabled:x,open:y,onOpenChange:C=>{C?b.onItemOpen(r):b.onItemClose(r)}})})});Hs.displayName=Ye;var Ks="AccordionHeader",Gs=le.forwardRef((a,o)=>{const{__scopeAccordion:l,...r}=a,h=as(he,l),u=fs(Ks,l);return e.jsx(Ds.h3,{"data-orientation":h.orientation,"data-state":Js(u.open),"data-disabled":u.disabled?"":void 0,...r,ref:o})});Gs.displayName=Ks;var ds="AccordionTrigger",Qs=le.forwardRef((a,o)=>{const{__scopeAccordion:l,...r}=a,h=as(he,l),u=fs(ds,l),b=hi(ds,l),_=gs(l);return e.jsx(js.ItemSlot,{scope:l,children:e.jsx(ca,{"aria-disabled":u.open&&!b.collapsible||void 0,"data-orientation":h.orientation,id:u.triggerId,..._,...r,ref:o})})});Qs.displayName=ds;var Bs="AccordionContent",Zs=le.forwardRef((a,o)=>{const{__scopeAccordion:l,...r}=a,h=as(he,l),u=fs(Bs,l),b=gs(l);return e.jsx(da,{role:"region","aria-labelledby":u.triggerId,"data-orientation":h.orientation,...b,...r,ref:o,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...a.style}})});Zs.displayName=Bs;function Js(a){return a?"open":"closed"}var fi=Ls,vi=Hs,Ni=Gs,Ys=Qs,Ws=Zs;const _i=fi,Xs=g.forwardRef(({className:a,...o},l)=>e.jsx(vi,{ref:l,className:xe("border-b",a),...o}));Xs.displayName="AccordionItem";const ea=g.forwardRef(({className:a,children:o,...l},r)=>e.jsx(Ni,{className:"flex",children:e.jsxs(Ys,{ref:r,className:xe("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",a),...l,children:[o,e.jsx(xs,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));ea.displayName=Ys.displayName;const sa=g.forwardRef(({className:a,children:o,...l},r)=>e.jsx(Ws,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...l,children:e.jsx("div",{className:xe("pb-4 pt-0",a),children:o})}));sa.displayName=Ws.displayName;function bi({open:a,onOpenChange:o,items:l,saveItems:r,userId:h}){const{settings:u,updateSettings:b,isUpdating:_}=es(h),[m,y]=g.useState(""),[x,C]=g.useState(new Set),[d,j]=g.useState(!1);g.useEffect(()=>{u!=null&&u.disabled_ingredients&&C(new Set(u.disabled_ingredients))},[u==null?void 0:u.disabled_ingredients]);const p=g.useMemo(()=>{const c=new Map;return l.forEach(w=>{(w.ingredient||[]).forEach(U=>{const M=U.trim().toLowerCase();if(!M)return;const R=c.get(M)||{count:0,productIds:[]};R.count+=1,R.productIds.push(w.id),c.set(M,R)})}),Array.from(c.entries()).map(([w,N])=>({name:w,displayName:w.charAt(0).toUpperCase()+w.slice(1),count:N.count,productIds:N.productIds})).sort((w,N)=>w.name.localeCompare(N.name,"fr"))},[l]),P=g.useMemo(()=>{if(!m)return p;const c=m.toLowerCase();return p.filter(w=>w.name.includes(c))},[p,m]),O=g.useMemo(()=>{const c=new Set;return p.forEach(w=>{x.has(w.name)&&w.productIds.forEach(N=>c.add(N))}),c.size},[p,x]),T=c=>{C(w=>{const N=new Set(w);return N.has(c)?N.delete(c):N.add(c),N})},$=async()=>{j(!0);try{const c=Array.from(x),w=l.map(N=>{const M=(N.ingredient||[]).map(R=>R.trim().toLowerCase()).some(R=>x.has(R));return{...N,is_active:!M}});await new Promise((N,U)=>{b({disabled_ingredients:c},{onSuccess:()=>N(),onError:M=>U(M)})}),r(w),ee.success(`${O} produit(s) mis √† jour`),o(!1)}catch(c){console.error("Error saving ingredients:",c),ee.error("Erreur lors de la sauvegarde")}finally{j(!1)}};return e.jsx(ua,{open:a,onOpenChange:o,children:e.jsxs(ha,{className:"w-full sm:max-w-lg flex flex-col",children:[e.jsxs(xa,{children:[e.jsxs(pa,{className:"flex items-center gap-2",children:[e.jsx(Ka,{className:"h-5 w-5 text-green-600"}),"Gestion des ingr√©dients"]}),e.jsx(ja,{children:"D√©sactivez un ingr√©dient pour rendre indisponibles tous les produits qui le contiennent."})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-4 py-4 overflow-hidden",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Je,{className:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(F,{placeholder:"Rechercher un ingr√©dient...",value:m,onChange:c=>y(c.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[p.length," ingr√©dient(s) au total"]}),e.jsxs(V,{variant:x.size>0?"destructive":"secondary",children:[x.size," d√©sactiv√©(s)"]})]}),x.size>0&&e.jsxs(ye,{variant:"destructive",className:"py-2",children:[e.jsx(Qa,{className:"h-4 w-4"}),e.jsxs(we,{children:[O," produit(s) seront indisponibles"]})]}),e.jsx(Xe,{className:"flex-1 -mx-6 px-6",children:e.jsx("div",{className:"space-y-2",children:P.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:m?"Aucun ingr√©dient trouv√©":"Aucun ingr√©dient dans le catalogue"}):P.map(c=>{const w=x.has(c.name);return e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border transition-colors ${w?"bg-destructive/10 border-destructive/30":"bg-card"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`font-medium ${w?"text-destructive line-through":""}`,children:c.displayName}),e.jsxs(V,{variant:"outline",className:"text-xs",children:[c.count," produit",c.count>1?"s":""]})]}),e.jsx(pe,{checked:!w,onCheckedChange:()=>T(c.name)})]},c.name)})})})]}),e.jsxs(ga,{className:"gap-2 sm:gap-0",children:[e.jsx(f,{variant:"outline",onClick:()=>o(!1),children:"Annuler"}),e.jsxs(f,{onClick:$,disabled:d||_,children:[(d||_)&&e.jsx(ne,{className:"h-4 w-4 mr-2 animate-spin"}),"Sauvegarder"]})]})]})})}function yi({open:a,onOpenChange:o,onAddSuggestion:l,catalogueItems:r,menus:h}){const[u,b]=g.useState(""),[_,m]=g.useState(""),[y,x]=g.useState("product"),C=()=>{!u||!_||(l({trigger_product_id:u,suggested_product_id:_,type:y}),b(""),m(""),x("product"),o(!1))},d=()=>y==="menu"?h.map(j=>({id:j.id,name:j.label})):r.map(j=>({id:j.id,name:j.name}));return e.jsx(de,{open:a,onOpenChange:o,children:e.jsxs(oe,{className:"sm:max-w-[500px]",children:[e.jsxs(me,{children:[e.jsx(ue,{children:"Ajouter une suggestion"}),e.jsx(We,{children:"Cr√©ez une association pour que le chatbot recommande automatiquement un produit ou menu"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Type de suggestion"}),e.jsxs(ge,{value:y,onValueChange:j=>{x(j),m("")},children:[e.jsx(fe,{children:e.jsx(ve,{})}),e.jsxs(Ne,{children:[e.jsx(ie,{value:"product",children:"Produit"}),e.jsx(ie,{value:"menu",children:"Menu"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Quand le client commande"}),e.jsxs(ge,{value:u,onValueChange:b,children:[e.jsx(fe,{children:e.jsx(ve,{placeholder:"S√©lectionnez un produit"})}),e.jsx(Ne,{className:"max-h-[200px]",children:r.map(j=>e.jsx(ie,{value:j.id,children:j.name},j.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Le chatbot sugg√®re"}),e.jsxs(ge,{value:_,onValueChange:m,children:[e.jsx(fe,{children:e.jsx(ve,{placeholder:`S√©lectionnez un ${y==="menu"?"menu":"produit"}`})}),e.jsx(Ne,{className:"max-h-[200px]",children:d().map(j=>e.jsx(ie,{value:j.id,children:j.name},j.id))})]})]})]}),e.jsxs(ke,{children:[e.jsx(f,{variant:"outline",onClick:()=>o(!1),children:"Annuler"}),e.jsx(f,{onClick:C,disabled:!u||!_,children:"Ajouter la suggestion"})]})]})})}function wi({userId:a}){const{settings:o,updateSettings:l}=es(a),{items:r}=hs(),{menus:h}=Us(),[u,b]=g.useState([]),[_,m]=g.useState(!1);g.useEffect(()=>{o!=null&&o.product_suggestions&&b(o.product_suggestions)},[o]);const y=p=>{const P=[...u,p];b(P),l({product_suggestions:P}),m(!1)},x=p=>{const P=u.filter((O,T)=>T!==p);b(P),l({product_suggestions:P})},C=p=>{const P=r.find(O=>O.id===p);return(P==null?void 0:P.name)||p},d=p=>{const P=h.find(O=>O.id===p);return(P==null?void 0:P.label)||p},j=p=>{const P=C(p.trigger_product_id),O=p.type==="menu"?d(p.suggested_product_id):C(p.suggested_product_id);return{triggerName:P,suggestedName:O}};return e.jsxs(G,{children:[e.jsx(Fe,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(ws,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx(De,{children:"Suggestions Automatiques"}),e.jsx(us,{children:"Proposez des produits compl√©mentaires"})]})]}),e.jsxs(f,{onClick:()=>m(!0),size:"sm",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Ajouter"]})]})}),e.jsx(Y,{children:e.jsx("div",{className:"space-y-4",children:u.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground bg-muted/20 rounded-lg border border-dashed",children:[e.jsx(ws,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Aucune suggestion configur√©e"}),e.jsx(f,{variant:"link",onClick:()=>m(!0),children:"Cr√©er votre premi√®re suggestion"})]}):e.jsx("div",{className:"grid gap-3",children:u.map((p,P)=>{const{triggerName:O,suggestedName:T}=j(p);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg border group hover:border-primary/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[e.jsx(V,{variant:"outline",className:"bg-background shrink-0",children:"Si achat de"}),e.jsx("span",{className:"font-medium truncate",children:O}),e.jsx(ks,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsx(V,{variant:"outline",className:"bg-primary/5 border-primary/20 text-primary shrink-0",children:"Proposer"}),e.jsx("span",{className:"font-medium truncate",children:T})]}),e.jsx(f,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>x(P),children:e.jsx($e,{className:"h-4 w-4"})})]},P)})})})}),e.jsx(yi,{open:_,onOpenChange:m,onAddSuggestion:y,catalogueItems:r,menus:h})]})}function or({userId:a}={}){const{profile:o}=ms(),{canAccessAdvancedCatalogue:l}=zs(),r=a||(o==null?void 0:o.user_id),{items:h,isLoading:u,error:b,saveItems:_,isSaving:m,deleteItem:y}=hs({userId:a}),{settings:x,updateSettings:C}=es(r),[d,j]=g.useState(""),[p,P]=g.useState({}),[O,T]=g.useState(!1),[$,c]=g.useState(!1),[w,N]=g.useState(!1),[U,M]=g.useState(!1),[R,n]=g.useState(!1),[S,A]=g.useState(""),[Q,J]=g.useState([]),[i,s]=g.useState({name:"",ingredient:[],description:"",unit_price:0,currency:"EUR",vat_rate:10,is_active:!0,tags:"",allergens:""});g.useEffect(()=>{x!=null&&x.assets&&J(x.assets)},[x==null?void 0:x.assets]);const v=I=>{J(I),C({assets:I})};g.useEffect(()=>{!u&&h.length>0&&O&&(P({}),T(!1))},[h,u]);const k=g.useMemo(()=>h.filter(L=>String(L.name||"").toLowerCase().includes(d.toLowerCase())||String(L.description||"").toLowerCase().includes(d.toLowerCase())).reduce((L,z)=>(L[z.category]||(L[z.category]=[]),L[z.category].push(z),L),{}),[h,d]),D=Object.keys(k),B=(I,L,z)=>{P(K=>({...K,[I]:{...h.find(Ie=>Ie.id===I),...K[I],[L]:z}})),T(!0)},se=()=>{const I=h.map(L=>p[L.id]?{...L,...p[L.id]}:L);_(I)},He=()=>{P({}),T(!1)},te=(I,L)=>{var z,K;return((z=p[I])==null?void 0:z[L])??((K=h.find(Ie=>Ie.id===I))==null?void 0:K[L])},Te=()=>crypto.randomUUID(),is=()=>{if(!i.name.trim()){ee.error("Le nom du produit est obligatoire");return}const I={id:Te(),category:S,name:i.name,ingredient:i.ingredient,description:i.description,unit_price:i.unit_price,currency:i.currency,vat_rate:i.vat_rate,is_active:i.is_active,tags:i.tags?i.tags.split(",").map(z=>z.trim()):[],allergens:i.allergens?i.allergens.split(",").map(z=>z.trim()):[]},L=[...h,I];_(L),n(!1),s({name:"",ingredient:[],description:"",unit_price:0,currency:"EUR",vat_rate:10,is_active:!0,tags:"",allergens:""})},Oe=I=>{const L=h.find(z=>z.id===I);L&&confirm(`√ätes-vous s√ªr de vouloir supprimer "${L.name}" ?`)&&y(L)};return h.length===0&&!u?e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsx(G,{className:"border-2 border-dashed",children:e.jsx(Y,{className:"p-12",children:e.jsxs("div",{className:"text-center space-y-6 max-w-2xl mx-auto",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"rounded-full bg-primary/10 p-6",children:e.jsx(Ue,{className:"h-16 w-16 text-primary"})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Bienvenue dans votre catalogue"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Cr√©ez votre catalogue de produits en quelques clics et g√©rez facilement votre carte de menu, vos prix et vos descriptions."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-left py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[e.jsx(Ee,{className:"h-5 w-5 text-green-600"}),"Organisation par cat√©gories"]}),e.jsx("p",{className:"text-sm text-muted-foreground pl-7",children:"Structurez vos entr√©es, plats, desserts..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[e.jsx(Ee,{className:"h-5 w-5 text-green-600"}),"Gestion compl√®te"]}),e.jsx("p",{className:"text-sm text-muted-foreground pl-7",children:"Prix, ingr√©dients, allerg√®nes, descriptions"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[e.jsx(Ee,{className:"h-5 w-5 text-green-600"}),"Synchronisation automatique"]}),e.jsx("p",{className:"text-sm text-muted-foreground pl-7",children:"Vos produits disponibles sur tous vos canaux"})]})]}),e.jsxs(f,{size:"lg",className:"gap-2 text-lg px-8 py-6",onClick:()=>c(!0),children:[e.jsx(Ze,{className:"h-5 w-5"}),"Cr√©er mon premier catalogue"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"üí° La cr√©ation prend environ 5 minutes"})]})})}),e.jsx(bs,{open:$,onOpenChange:c,userId:r})]}):u?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(ne,{className:"h-8 w-8 animate-spin text-primary"})}):b?e.jsx("div",{className:"container mx-auto p-6",children:e.jsxs(ye,{variant:"destructive",children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsx(qe,{children:"Erreur"}),e.jsx(we,{children:"Impossible de charger le catalogue. Veuillez r√©essayer plus tard."})]})}):e.jsxs("div",{className:"container mx-auto p-4 md:p-6 space-y-6 pb-24 md:pb-6 min-w-0 overflow-x-hidden",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold flex items-center gap-3",children:[e.jsx(Ue,{className:"h-6 w-6 md:h-8 md:w-8"}),"Catalogue"]}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground mt-1 md:mt-2",children:"G√©rez vos produits, suppl√©ments et menus"})]})}),e.jsxs(Va,{defaultValue:"products",className:"space-y-4 md:space-y-6 w-full min-w-0",children:[e.jsx("div",{className:"w-full overflow-x-auto pb-2",children:e.jsxs(Ha,{className:"w-full justify-start md:justify-center h-auto p-1 bg-muted/50",children:[e.jsxs(Re,{value:"products",className:"flex-1 py-2 min-w-[80px]",children:[e.jsx(Ze,{className:"h-4 w-4 md:mr-2 shrink-0"}),e.jsx("span",{className:"hidden md:inline",children:"Produits"})]}),l&&e.jsxs(Re,{value:"suggestions",className:"flex-1 py-2 min-w-[80px]",children:[e.jsx(Ee,{className:"h-4 w-4 md:mr-2 shrink-0"}),e.jsx("span",{className:"hidden md:inline",children:"Suggestions"})]}),e.jsxs(Re,{value:"menus",className:"flex-1 py-2 min-w-[80px]",children:[e.jsx(Ue,{className:"h-4 w-4 md:mr-2 shrink-0"}),e.jsx("span",{className:"hidden md:inline",children:"Menus"})]}),e.jsxs(Re,{value:"addons",className:"flex-1 py-2 min-w-[80px]",children:[e.jsx(ce,{className:"h-4 w-4 md:mr-2 shrink-0"}),e.jsx("span",{className:"hidden md:inline",children:"Suppl√©ments"})]}),e.jsxs(Re,{value:"images",className:"flex-1 py-2 min-w-[80px]",children:[e.jsx(Rs,{className:"h-4 w-4 md:mr-2 shrink-0"}),e.jsx("span",{className:"hidden md:inline",children:"Images"})]})]})}),e.jsxs(Pe,{value:"products",className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 w-full",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(f,{onClick:()=>N(!0),className:"flex-1 sm:flex-none",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"truncate",children:"Ajouter cat√©gorie"})]}),l&&e.jsxs(f,{variant:"outline",onClick:()=>M(!0),className:"flex-1 sm:flex-none",children:[e.jsx(Ga,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"truncate",children:"G√©rer les ingr√©dients"})]})]}),e.jsxs(V,{variant:"outline",className:"text-sm px-3 py-1 whitespace-nowrap shrink-0",children:[h.length," produits"]})]}),e.jsx(bi,{open:U,onOpenChange:M,items:h,saveItems:_,userId:r}),e.jsx(G,{children:e.jsx(Y,{className:"p-4 md:pt-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(Je,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(F,{placeholder:"Rechercher un produit...",value:d,onChange:I=>j(I.target.value),className:"pl-10"})]})})}),e.jsx(G,{children:e.jsx(Y,{className:"p-2 md:pt-6",children:e.jsx(_i,{type:"multiple",className:"w-full",children:Object.entries(k).map(([I,L])=>e.jsxs(Xs,{value:I,children:[e.jsx(ea,{className:"text-base md:text-lg font-semibold hover:no-underline px-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between w-full pr-4 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate",children:I}),e.jsx(V,{variant:"secondary",className:"ml-2",children:L.length})]}),e.jsxs(f,{size:"sm",className:"bg-green-600 hover:bg-green-700 w-full sm:w-auto mt-2 sm:mt-0",onClick:z=>{z.stopPropagation(),A(I),n(!0)},children:[e.jsx(ce,{className:"h-4 w-4 mr-1"}),"Ajouter"]})]})}),e.jsx(sa,{children:e.jsx("div",{className:"space-y-4 pt-4 px-1",children:L.map(z=>e.jsxs(G,{className:"p-3 md:p-4",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsxs(f,{variant:"destructive",size:"sm",onClick:()=>Oe(z.id),className:"h-8 w-8 p-0 md:w-auto md:px-3 md:py-2",children:[e.jsx(be,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Supprimer"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Nom du produit"}),e.jsx(F,{value:te(z.id,"name"),onChange:K=>B(z.id,"name",K.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Ingr√©dients"}),e.jsx(Le,{value:te(z.id,"ingredient"),onChange:K=>B(z.id,"ingredient",K),placeholder:"Ajouter des ingr√©dients...",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(Be,{value:te(z.id,"description"),onChange:K=>B(z.id,"description",K.target.value),className:"mt-1",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Prix unitaire (‚Ç¨)"}),e.jsx(F,{type:"number",step:"0.01",value:te(z.id,"unit_price"),onChange:K=>B(z.id,"unit_price",parseFloat(K.target.value)||0),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"TVA (%)"}),e.jsx(F,{type:"number",value:te(z.id,"vat_rate"),onChange:K=>B(z.id,"vat_rate",parseFloat(K.target.value)||0),className:"mt-1"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Tags"}),e.jsx(F,{value:te(z.id,"tags"),onChange:K=>B(z.id,"tags",K.target.value),className:"mt-1",placeholder:"Ex: v√©g√©tarien, √©pic√©"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Allerg√®nes"}),e.jsx(Be,{value:te(z.id,"allergens"),onChange:K=>B(z.id,"allergens",K.target.value),className:"mt-1",placeholder:"Ex: Gluten, Lactose",rows:2})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[e.jsx(pe,{checked:te(z.id,"is_active"),onCheckedChange:K=>B(z.id,"is_active",K)}),e.jsx("span",{className:"text-sm font-medium",children:"Produit actif"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1 pt-2",children:[e.jsxs("div",{children:["ID: ",z.id]}),e.jsxs("div",{children:["Cat√©gorie: ",z.category]})]})]})]})]},z.id))})})]},I))})})}),O&&e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 md:bottom-6 md:right-6 md:left-auto flex gap-3 bg-background border-t md:border rounded-none md:rounded-lg p-4 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] md:shadow-lg z-50",children:[e.jsx(f,{variant:"outline",onClick:He,disabled:m,className:"flex-1 md:flex-none",children:"Annuler"}),e.jsxs(f,{onClick:se,disabled:m,className:"gap-2 flex-1 md:flex-none",children:[m?e.jsx(ne,{className:"h-4 w-4 animate-spin"}):e.jsx(Ba,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Sauvegarder les modifications"}),e.jsx("span",{className:"md:hidden",children:"Sauvegarder"})]})]}),e.jsx(de,{open:R,onOpenChange:n,children:e.jsxs(oe,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(me,{children:e.jsxs(ue,{children:["Ajouter un produit - ",S]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Nom du produit *"}),e.jsx(F,{value:i.name,onChange:I=>s({...i,name:I.target.value}),placeholder:"Ex: Pizza Margherita"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Ingr√©dients"}),e.jsx(Le,{value:i.ingredient,onChange:I=>s({...i,ingredient:I}),placeholder:"Ajouter des ingr√©dients..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(Be,{value:i.description,onChange:I=>s({...i,description:I.target.value}),placeholder:"Description du produit",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Prix (‚Ç¨)"}),e.jsx(F,{type:"number",step:"0.01",value:i.unit_price,onChange:I=>s({...i,unit_price:parseFloat(I.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"TVA (%)"}),e.jsx(F,{type:"number",value:i.vat_rate,onChange:I=>s({...i,vat_rate:parseFloat(I.target.value)||0})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Tags"}),e.jsx(F,{value:i.tags,onChange:I=>s({...i,tags:I.target.value}),placeholder:"Ex: v√©g√©tarien, √©pic√©"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Allerg√®nes"}),e.jsx(F,{value:i.allergens,onChange:I=>s({...i,allergens:I.target.value}),placeholder:"Ex: Gluten, Lactose"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{checked:i.is_active,onCheckedChange:I=>s({...i,is_active:I})}),e.jsx("span",{className:"text-sm",children:"Produit actif"})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end mt-4",children:[e.jsx(f,{variant:"outline",onClick:()=>n(!1),children:"Annuler"}),e.jsxs(f,{onClick:is,disabled:!i.name.trim(),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Ajouter"]})]})]})})]}),e.jsx(Pe,{value:"suggestions",children:e.jsx(wi,{userId:r})}),e.jsx(Pe,{value:"availability",children:e.jsxs(G,{children:[e.jsxs(Fe,{children:[e.jsx(De,{children:"Disponibilit√© des Produits"}),e.jsx(us,{children:"Activez ou d√©sactivez rapidement vos produits"})]}),e.jsx(Y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Je,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(F,{placeholder:"Rechercher un produit...",value:d,onChange:I=>j(I.target.value),className:"pl-8"})]}),e.jsx("div",{className:"grid gap-2 max-h-[600px] overflow-y-auto",children:h.filter(I=>I.name.toLowerCase().includes(d.toLowerCase())).map(I=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsx("span",{className:"font-medium",children:I.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm ${te(I.id,"is_active")?"text-green-600":"text-muted-foreground"}`,children:te(I.id,"is_active")?"Disponible":"Indisponible"}),e.jsx(pe,{checked:te(I.id,"is_active"),onCheckedChange:L=>B(I.id,"is_active",L)})]})]},I.id))})]})})]})}),e.jsx(Pe,{value:"images",children:e.jsx(G,{children:e.jsx(Y,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Images de votre menu"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Uploadez les images de votre carte pour le chatbot. Vous pouvez indiquer plusieurs cat√©gories dans la m√™me image."})]}),r&&e.jsx(ci,{userId:r,assets:Q,onAssetsChange:v})]})})})}),e.jsx(Pe,{value:"addons",children:e.jsx(Wa,{userId:r})}),e.jsx(Pe,{value:"menus",className:"min-w-0 overflow-hidden overflow-x-hidden",children:e.jsx(ti,{userId:r,catalogItems:h})})]}),e.jsx(Ja,{open:w,onOpenChange:N,userId:r,existingCategories:D}),e.jsx(bs,{open:$,onOpenChange:c,userId:r})]})}export{or as default};
