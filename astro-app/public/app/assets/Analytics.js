import{r as I,d as M,u as V,j as e,B as L,C as l,a as d,b as m,T as $,c as x,h as t,f as S,U as R,A as B,g as P}from"./index.js";import{a as T,u as E,b as D,c as U}from"./useSatisfactionAnalytics.js";import{u as J,a as O}from"./useAnalyticsExport.js";import{F as W}from"./file-text.js";import{F as q}from"./file-spreadsheet.js";import{S as z}from"./star.js";import{C as G}from"./clock.js";import"./useQuery.js";import"./endOfWeek.js";import"./fr.js";function H(){const{peakDay:v,peakDayOrders:p,weekendVsWeekdayRatio:u,isLoading:f}=T(),{growthPercentage:r,bestCategory:j,bestCategoryPercentage:n,isLoading:b}=E(),{topProduct:o,isLoading:C}=J(),{retentionRate:g,loyalCustomers:y,isLoading:N}=D(),{averageRating:h,ratingChange:i,isLoading:w}=U(),c=f||b||C||N||w;return{insights:I.useMemo(()=>{if(c)return[];const s=[];return r>10?s.push({type:"success",title:"Croissance des revenus",description:`+${r}% de revenus ce mois comparé au mois dernier`,icon:"TrendingUp"}):r<-10&&s.push({type:"warning",title:"Baisse des revenus",description:`${r}% de revenus ce mois. Analysez les tendances pour comprendre`,icon:"TrendingUp"}),p>0&&s.push({type:"info",title:"Jour de pointe détecté",description:`${v} est votre jour le plus actif avec ${p} commandes`,icon:"Clock"}),n>0&&s.push({type:"success",title:"Catégorie star",description:`${j} représente ${n}% de votre chiffre d'affaires`,icon:"ShoppingCart"}),h>=4.5?s.push({type:"success",title:"Satisfaction exceptionnelle",description:`Note moyenne de ${h.toFixed(1)}/5 - Vos clients sont ravis !`,icon:"Star"}):i>0?s.push({type:"success",title:"Satisfaction en hausse",description:`+${i.toFixed(1)} points ce mois grâce à vos efforts`,icon:"Star"}):i<-.2&&s.push({type:"warning",title:"Satisfaction en baisse",description:`${i.toFixed(1)} points ce mois. Analysez les avis récents`,icon:"Star"}),g>=50&&s.push({type:"success",title:"Excellente fidélisation",description:`${g}% de vos clients reviennent - ${y} clients fidèles`,icon:"Users"}),o&&s.push({type:"info",title:"Produit star",description:`"${o.name}" domine vos ventes avec ${o.percentage.toFixed(1)}% des commandes`,icon:"ShoppingCart"}),u>20&&s.push({type:"info",title:"Weekend populaire",description:`Les weekends génèrent ${u}% de commandes en plus`,icon:"Clock"}),s.slice(0,3)},[c,r,v,p,j,n,h,i,g,y,o,u]),isLoading:c}}const K={TrendingUp:$,Clock:G,Star:z,Users:R,ShoppingCart:S},Q={success:{bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",iconColor:"text-green-600",titleColor:"text-green-800 dark:text-green-200",descColor:"text-green-600 dark:text-green-300"},info:{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-200 dark:border-blue-800",iconColor:"text-blue-600",titleColor:"text-blue-800 dark:text-blue-200",descColor:"text-blue-600 dark:text-blue-300"},warning:{bg:"bg-orange-50 dark:bg-orange-900/20",border:"border-orange-200 dark:border-orange-800",iconColor:"text-orange-600",titleColor:"text-orange-800 dark:text-orange-200",descColor:"text-orange-600 dark:text-orange-300"}},ne=()=>{const{profile:v}=M(),p=V(),{revenueThisMonth:u,growthPercentage:f,isLoading:r}=E(),{ordersThisMonth:j,ordersGrowth:n,isLoading:b}=T(),{retentionRate:o,isLoading:C}=D(),{averageRating:g,isLoading:y}=U(),{insights:N,isLoading:h}=H(),{exportPDF:i,exportExcel:w,isExporting:c}=O(),F=[{title:"Revenus & Performance",description:"Revenus par semaine, par catégorie et tendances",icon:$,route:"/analytics/revenue",metrics:["Revenu hebdomadaire","Revenu par catégorie","Croissance"],color:"from-green-500 to-emerald-600"},{title:"Commandes & Produits",description:"Analyse des commandes et produits populaires",icon:S,route:"/analytics/orders",metrics:["Jours de pointe","Produits les plus vendus","Volume"],color:"from-blue-500 to-cyan-600"},{title:"Métriques Client",description:"Rétention, satisfaction et comportement",icon:R,route:"/analytics/customers",metrics:["Taux de rétention","Satisfaction client","Temps de conversion"],color:"from-purple-500 to-violet-600"}];return e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 animate-fade-in",children:[e.jsxs("div",{className:"text-center md:text-left space-y-2",children:[e.jsxs("h1",{className:"text-4xl font-bold",children:["Analytics"," ",e.jsx("span",{className:"bg-gradient-to-r from-primary to-primary-light bg-clip-text text-transparent",children:"Dashboard"})]}),e.jsx("p",{className:"text-muted-foreground text-lg max-w-2xl",children:"Découvrez les performances de votre restaurant avec des analyses détaillées et interactives."})]}),e.jsxs("div",{className:"flex gap-2 justify-center md:justify-end",children:[e.jsxs(L,{onClick:i,disabled:c,variant:"outline",className:"gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),"Export PDF"]}),e.jsxs(L,{onClick:w,disabled:c,variant:"outline",className:"gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Export Excel"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 animate-slide-up",children:[e.jsxs(l,{className:"border-primary/10 bg-gradient-to-br from-primary/5 to-primary/10",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Revenus ce mois"}),e.jsx($,{className:"h-4 w-4 text-primary"})]}),e.jsxs(x,{children:[r?e.jsx(t,{className:"h-8 w-24"}):e.jsxs("div",{className:"text-2xl font-bold text-primary",children:["€",u.toLocaleString("fr-FR")]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r?e.jsx(t,{className:"h-3 w-20 mt-1"}):e.jsxs(e.Fragment,{children:[f>=0?"+":"",f,"% vs mois dernier"]})})]})]}),e.jsxs(l,{className:"border-primary/10 bg-gradient-to-br from-blue-500/5 to-blue-500/10",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Commandes"}),e.jsx(S,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(x,{children:[b?e.jsx(t,{className:"h-8 w-16"}):e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:j.toLocaleString("fr-FR")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:b?e.jsx(t,{className:"h-3 w-20 mt-1"}):e.jsxs(e.Fragment,{children:[n>=0?"+":"",n,"% vs mois dernier"]})})]})]}),e.jsxs(l,{className:"border-primary/10 bg-gradient-to-br from-purple-500/5 to-purple-500/10",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Rétention"}),e.jsx(R,{className:"h-4 w-4 text-purple-600"})]}),e.jsxs(x,{children:[C?e.jsx(t,{className:"h-8 w-16"}):e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[o,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Clients fidèles"})]})]}),e.jsxs(l,{className:"border-primary/10 bg-gradient-to-br from-orange-500/5 to-orange-500/10",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Satisfaction"}),e.jsx(z,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(x,{children:[y?e.jsx(t,{className:"h-8 w-16"}):e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[g.toFixed(1),"/5"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Note moyenne"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 animate-slide-up animation-delay-200",children:F.map((s,A)=>e.jsxs(l,{className:"hover-lift cursor-pointer border-primary/10 hover:border-primary/20 transition-all duration-300 group",onClick:()=>p(s.route),children:[e.jsxs(d,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`p-3 rounded-lg bg-gradient-to-r ${s.color} text-white`,children:e.jsx(s.icon,{className:"h-6 w-6"})}),e.jsx(B,{className:"h-5 w-5 text-muted-foreground group-hover:text-primary transition-colors"})]}),e.jsx(m,{className:"text-xl",children:s.title}),e.jsx(P,{className:"text-sm",children:s.description})]}),e.jsxs(x,{children:[e.jsx("div",{className:"space-y-2",children:s.metrics.map((k,a)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-primary/60 rounded-full"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:k})]},a))}),e.jsx(L,{className:"w-full mt-4",variant:"outline",children:"Voir les détails"})]})]},s.route))}),e.jsxs(l,{className:"animate-slide-up animation-delay-400",children:[e.jsxs(d,{children:[e.jsx(m,{children:"Insights récents"}),e.jsx(P,{children:"Découvertes et tendances importantes basées sur vos données"})]}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:h?e.jsxs(e.Fragment,{children:[e.jsx(t,{className:"h-20 w-full"}),e.jsx(t,{className:"h-20 w-full"}),e.jsx(t,{className:"h-20 w-full"})]}):N.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Pas assez de données pour générer des insights. Continuez à recevoir des commandes !"}):N.map((s,A)=>{const k=K[s.icon],a=Q[s.type];return e.jsxs("div",{className:`flex items-start space-x-4 p-4 ${a.bg} rounded-lg border ${a.border}`,children:[e.jsx(k,{className:`h-5 w-5 ${a.iconColor} mt-0.5`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm font-medium ${a.titleColor}`,children:s.title}),e.jsx("p",{className:`text-xs ${a.descColor}`,children:s.description})]})]},A)})})})]})]})};export{ne as default};
