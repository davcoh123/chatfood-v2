import{R as _}from"./index.js";var ge=e=>e.type==="checkbox",ne=e=>e instanceof Date,z=e=>e==null;const ut=e=>typeof e=="object";var U=e=>!z(e)&&!Array.isArray(e)&&ut(e)&&!ne(e),lt=e=>U(e)&&e.target?ge(e.target)?e.target.checked:e.target.value:e,Ct=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,ot=(e,s)=>e.has(Ct(s)),Ot=e=>{const s=e.constructor&&e.constructor.prototype;return U(s)&&s.hasOwnProperty("isPrototypeOf")},Oe=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function R(e){if(e instanceof Date)return new Date(e);const s=typeof FileList<"u"&&e instanceof FileList;if(Oe&&(e instanceof Blob||s))return e;const t=Array.isArray(e);if(!t&&!(U(e)&&Ot(e)))return e;const i=t?[]:Object.create(Object.getPrototypeOf(e));for(const u in e)Object.prototype.hasOwnProperty.call(e,u)&&(i[u]=R(e[u]));return i}var be=e=>/^\w*$/.test(e),O=e=>e===void 0,Re=e=>Array.isArray(e)?e.filter(Boolean):[],Te=e=>Re(e.replace(/["|']|\]/g,"").split(/\.|\[/)),y=(e,s,t)=>{if(!s||!U(e))return t;const i=(be(s)?[s]:Te(s)).reduce((u,n)=>z(u)?u:u[n],e);return O(i)||i===e?O(e[s])?t:e[s]:i},Y=e=>typeof e=="boolean",H=e=>typeof e=="function",C=(e,s,t)=>{let i=-1;const u=be(s)?[s]:Te(s),n=u.length,o=n-1;for(;++i<n;){const c=u[i];let A=t;if(i!==o){const k=e[c];A=U(k)||Array.isArray(k)?k:isNaN(+u[i+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;e[c]=A,e=e[c]}};const _e={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},X={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},se={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Ue=_.createContext(null);Ue.displayName="HookFormContext";const Le=()=>_.useContext(Ue),Zt=e=>{const{children:s,...t}=e;return _.createElement(Ue.Provider,{value:t},s)};var ft=(e,s,t,i=!0)=>{const u={defaultValues:s._defaultValues};for(const n in e)Object.defineProperty(u,n,{get:()=>{const o=n;return s._proxyFormState[o]!==X.all&&(s._proxyFormState[o]=!i||X.all),t&&(t[o]=!0),e[o]}});return u};const Me=typeof window<"u"?_.useLayoutEffect:_.useEffect;function Rt(e){const s=Le(),{control:t=s.control,disabled:i,name:u,exact:n}=e||{},[o,c]=_.useState(t._formState),A=_.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return Me(()=>t._subscribe({name:u,formState:A.current,exact:n,callback:k=>{!i&&c({...t._formState,...k})}}),[u,i,n]),_.useEffect(()=>{A.current.isValid&&t._setValid(!0)},[t]),_.useMemo(()=>ft(o,t,A.current,!1),[o,t])}var $=e=>typeof e=="string",De=(e,s,t,i,u)=>$(e)?(i&&s.watch.add(e),y(t,e,u)):Array.isArray(e)?e.map(n=>(i&&s.watch.add(n),y(t,n))):(i&&(s.watchAll=!0),t),Se=e=>z(e)||!ut(e);function Z(e,s,t=new WeakSet){if(Se(e)||Se(s))return Object.is(e,s);if(ne(e)&&ne(s))return Object.is(e.getTime(),s.getTime());const i=Object.keys(e),u=Object.keys(s);if(i.length!==u.length)return!1;if(t.has(e)||t.has(s))return!0;t.add(e),t.add(s);for(const n of i){const o=e[n];if(!u.includes(n))return!1;if(n!=="ref"){const c=s[n];if(ne(o)&&ne(c)||U(o)&&U(c)||Array.isArray(o)&&Array.isArray(c)?!Z(o,c,t):!Object.is(o,c))return!1}}return!0}function Tt(e){const s=Le(),{control:t=s.control,name:i,defaultValue:u,disabled:n,exact:o,compute:c}=e||{},A=_.useRef(u),k=_.useRef(c),j=_.useRef(void 0),v=_.useRef(t),E=_.useRef(i);k.current=c;const[V,P]=_.useState(()=>{const b=t._getWatch(i,A.current);return k.current?k.current(b):b}),L=_.useCallback(b=>{const x=De(i,t._names,b||t._formValues,!1,A.current);return k.current?k.current(x):x},[t._formValues,t._names,i]),p=_.useCallback(b=>{if(!n){const x=De(i,t._names,b||t._formValues,!1,A.current);if(k.current){const K=k.current(x);Z(K,j.current)||(P(K),j.current=K)}else P(x)}},[t._formValues,t._names,n,i]);Me(()=>((v.current!==t||!Z(E.current,i))&&(v.current=t,E.current=i,p()),t._subscribe({name:i,formState:{values:!0},exact:o,callback:b=>{p(b.values)}})),[t,o,i,p]),_.useEffect(()=>t._removeUnmounted());const M=v.current!==t,m=E.current,B=_.useMemo(()=>{if(n)return null;const b=!M&&!Z(m,i);return M||b?L():null},[n,M,i,m,L]);return B!==null?B:V}function Ut(e){const s=Le(),{name:t,disabled:i,control:u=s.control,shouldUnregister:n,defaultValue:o,exact:c=!0}=e,A=ot(u._names.array,t),k=_.useMemo(()=>y(u._formValues,t,y(u._defaultValues,t,o)),[u,t,o]),j=Tt({control:u,name:t,defaultValue:k,exact:c}),v=Rt({control:u,name:t,exact:c}),E=_.useRef(e),V=_.useRef(void 0),P=_.useRef(u.register(t,{...e.rules,value:j,...Y(e.disabled)?{disabled:e.disabled}:{}}));E.current=e;const L=_.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!y(v.errors,t)},isDirty:{enumerable:!0,get:()=>!!y(v.dirtyFields,t)},isTouched:{enumerable:!0,get:()=>!!y(v.touchedFields,t)},isValidating:{enumerable:!0,get:()=>!!y(v.validatingFields,t)},error:{enumerable:!0,get:()=>y(v.errors,t)}}),[v,t]),p=_.useCallback(b=>P.current.onChange({target:{value:lt(b),name:t},type:_e.CHANGE}),[t]),M=_.useCallback(()=>P.current.onBlur({target:{value:y(u._formValues,t),name:t},type:_e.BLUR}),[t,u._formValues]),m=_.useCallback(b=>{const x=y(u._fields,t);x&&x._f&&b&&(x._f.ref={focus:()=>H(b.focus)&&b.focus(),select:()=>H(b.select)&&b.select(),setCustomValidity:K=>H(b.setCustomValidity)&&b.setCustomValidity(K),reportValidity:()=>H(b.reportValidity)&&b.reportValidity()})},[u._fields,t]),B=_.useMemo(()=>({name:t,value:j,...Y(i)||v.disabled?{disabled:v.disabled||i}:{},onChange:p,onBlur:M,ref:m}),[t,i,v.disabled,p,M,m,j]);return _.useEffect(()=>{const b=u._options.shouldUnregister||n,x=V.current;x&&x!==t&&!A&&u.unregister(x),u.register(t,{...E.current.rules,...Y(E.current.disabled)?{disabled:E.current.disabled}:{}});const K=(te,re)=>{const ee=y(u._fields,te);ee&&ee._f&&(ee._f.mount=re)};if(K(t,!0),b){const te=R(y(u._options.defaultValues,t,E.current.defaultValue));C(u._defaultValues,t,te),O(y(u._formValues,t))&&C(u._formValues,t,te)}return!A&&u.register(t),V.current=t,()=>{(A?b&&!u._state.action:b)?u.unregister(t):K(t,!1)}},[t,u,A,n]),_.useEffect(()=>{u._setDisabledField({disabled:i,name:t})},[i,t,u]),_.useMemo(()=>({field:B,formState:v,fieldState:L}),[B,v,L])}const er=e=>e.render(Ut(e));var ct=(e,s,t,i,u)=>s?{...t[e],types:{...t[e]&&t[e].types?t[e].types:{},[i]:u||!0}}:{},ye=e=>Array.isArray(e)?e:[e],$e=()=>{let e=[];return{get observers(){return e},next:u=>{for(const n of e)n.next&&n.next(u)},subscribe:u=>(e.push(u),{unsubscribe:()=>{e=e.filter(n=>n!==u)}}),unsubscribe:()=>{e=[]}}};function dt(e,s){const t={};for(const i in e)if(e.hasOwnProperty(i)){const u=e[i],n=s[i];if(u&&U(u)&&n){const o=dt(u,n);U(o)&&(t[i]=o)}else e[i]&&(t[i]=n)}return t}var q=e=>U(e)&&!Object.keys(e).length,Ne=e=>e.type==="file",Ve=e=>{if(!Oe)return!1;const s=e?e.ownerDocument:0;return e instanceof(s&&s.defaultView?s.defaultView.HTMLElement:HTMLElement)},yt=e=>e.type==="select-multiple",pe=e=>e.type==="radio",Lt=e=>pe(e)||ge(e),Ee=e=>Ve(e)&&e.isConnected;function Mt(e,s){const t=s.slice(0,-1).length;let i=0;for(;i<t;)e=O(e)?i++:e[s[i++]];return e}function Nt(e){for(const s in e)if(e.hasOwnProperty(s)&&!O(e[s]))return!1;return!0}function T(e,s){const t=Array.isArray(s)?s:be(s)?[s]:Te(s),i=t.length===1?e:Mt(e,t),u=t.length-1,n=t[u];return i&&delete i[n],u!==0&&(U(i)&&q(i)||Array.isArray(i)&&Nt(i))&&T(e,t.slice(0,-1)),e}var pt=e=>{for(const s in e)if(H(e[s]))return!0;return!1};function ht(e){return Array.isArray(e)||U(e)&&!pt(e)}function Ce(e,s={}){for(const t in e){const i=e[t];ht(i)?(s[t]=Array.isArray(i)?[]:{},Ce(i,s[t])):O(i)||(s[t]=!0)}return s}function le(e,s,t){t||(t=Ce(s));for(const i in e){const u=e[i];if(ht(u))O(s)||Se(t[i])?t[i]=Ce(u,Array.isArray(u)?[]:{}):le(u,z(s)?{}:s[i],t[i]);else{const n=s[i];t[i]=!Z(u,n)}}return t}const Je={value:!1,isValid:!1},Qe={value:!0,isValid:!0};var gt=e=>{if(Array.isArray(e)){if(e.length>1){const s=e.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:s,isValid:!!s.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!O(e[0].attributes.value)?O(e[0].value)||e[0].value===""?Qe:{value:e[0].value,isValid:!0}:Qe:Je}return Je},vt=(e,{valueAsNumber:s,valueAsDate:t,setValueAs:i})=>O(e)?e:s?e===""?NaN:e&&+e:t&&$(e)?new Date(e):i?i(e):e;const Xe={isValid:!1,value:null};var _t=e=>Array.isArray(e)?e.reduce((s,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:s,Xe):Xe;function Ze(e){const s=e.ref;return Ne(s)?s.files:pe(s)?_t(e.refs).value:yt(s)?[...s.selectedOptions].map(({value:t})=>t):ge(s)?gt(e.refs).value:vt(O(s.value)?e.ref.value:s.value,e)}var It=(e,s,t,i)=>{const u={};for(const n of e){const o=y(s,n);o&&C(u,n,o._f)}return{criteriaMode:t,names:[...e],fields:u,shouldUseNativeValidation:i}},me=e=>e instanceof RegExp,de=e=>O(e)?e:me(e)?e.source:U(e)?me(e.value)?e.value.source:e.value:e,et=e=>({isOnSubmit:!e||e===X.onSubmit,isOnBlur:e===X.onBlur,isOnChange:e===X.onChange,isOnAll:e===X.all,isOnTouch:e===X.onTouched});const tt="AsyncFunction";var Pt=e=>!!e&&!!e.validate&&!!(H(e.validate)&&e.validate.constructor.name===tt||U(e.validate)&&Object.values(e.validate).find(s=>s.constructor.name===tt)),Bt=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),rt=(e,s,t)=>!t&&(s.watchAll||s.watch.has(e)||[...s.watch].some(i=>e.startsWith(i)&&/^\.\w+/.test(e.slice(i.length))));const he=(e,s,t,i)=>{for(const u of t||Object.keys(e)){const n=y(e,u);if(n){const{_f:o,...c}=n;if(o){if(o.refs&&o.refs[0]&&s(o.refs[0],u)&&!i)return!0;if(o.ref&&s(o.ref,o.name)&&!i)return!0;if(he(c,s))break}else if(U(c)&&he(c,s))break}}};function st(e,s,t){const i=y(e,t);if(i||be(t))return{error:i,name:t};const u=t.split(".");for(;u.length;){const n=u.join("."),o=y(s,n),c=y(e,n);if(o&&!Array.isArray(o)&&t!==n)return{name:t};if(c&&c.type)return{name:n,error:c};if(c&&c.root&&c.root.type)return{name:`${n}.root`,error:c.root};u.pop()}return{name:t}}var Wt=(e,s,t,i)=>{t(e);const{name:u,...n}=e;return q(n)||Object.keys(n).length>=Object.keys(s).length||Object.keys(n).find(o=>s[o]===(!i||X.all))},qt=(e,s,t)=>!e||!s||e===s||ye(e).some(i=>i&&(t?i===s:i.startsWith(s)||s.startsWith(i))),Ht=(e,s,t,i,u)=>u.isOnAll?!1:!t&&u.isOnTouch?!(s||e):(t?i.isOnBlur:u.isOnBlur)?!e:(t?i.isOnChange:u.isOnChange)?e:!0,jt=(e,s)=>!Re(y(e,s)).length&&T(e,s),Kt=(e,s,t)=>{const i=ye(y(e,t));return C(i,"root",s[t]),C(e,t,i),e};function it(e,s,t="validate"){if($(e)||Array.isArray(e)&&e.every($)||Y(e)&&!e)return{type:t,message:$(e)?e:"",ref:s}}var ue=e=>U(e)&&!me(e)?e:{value:e,message:""},at=async(e,s,t,i,u,n)=>{const{ref:o,refs:c,required:A,maxLength:k,minLength:j,min:v,max:E,pattern:V,validate:P,name:L,valueAsNumber:p,mount:M}=e._f,m=y(t,L);if(!M||s.has(L))return{};const B=c?c[0]:o,b=F=>{u&&B.reportValidity&&(B.setCustomValidity(Y(F)?"":F||""),B.reportValidity())},x={},K=pe(o),te=ge(o),re=K||te,ee=(p||Ne(o))&&O(o.value)&&O(m)||Ve(o)&&o.value===""||m===""||Array.isArray(m)&&!m.length,J=ct.bind(null,L,i,x),ve=(F,w,N,I=se.maxLength,Q=se.minLength)=>{const G=F?w:N;x[L]={type:F?I:Q,message:G,ref:o,...J(F?I:Q,G)}};if(n?!Array.isArray(m)||!m.length:A&&(!re&&(ee||z(m))||Y(m)&&!m||te&&!gt(c).isValid||K&&!_t(c).isValid)){const{value:F,message:w}=$(A)?{value:!!A,message:A}:ue(A);if(F&&(x[L]={type:se.required,message:w,ref:B,...J(se.required,w)},!i))return b(w),x}if(!ee&&(!z(v)||!z(E))){let F,w;const N=ue(E),I=ue(v);if(!z(m)&&!isNaN(m)){const Q=o.valueAsNumber||m&&+m;z(N.value)||(F=Q>N.value),z(I.value)||(w=Q<I.value)}else{const Q=o.valueAsDate||new Date(m),G=ce=>new Date(new Date().toDateString()+" "+ce),oe=o.type=="time",fe=o.type=="week";$(N.value)&&m&&(F=oe?G(m)>G(N.value):fe?m>N.value:Q>new Date(N.value)),$(I.value)&&m&&(w=oe?G(m)<G(I.value):fe?m<I.value:Q<new Date(I.value))}if((F||w)&&(ve(!!F,N.message,I.message,se.max,se.min),!i))return b(x[L].message),x}if((k||j)&&!ee&&($(m)||n&&Array.isArray(m))){const F=ue(k),w=ue(j),N=!z(F.value)&&m.length>+F.value,I=!z(w.value)&&m.length<+w.value;if((N||I)&&(ve(N,F.message,w.message),!i))return b(x[L].message),x}if(V&&!ee&&$(m)){const{value:F,message:w}=ue(V);if(me(F)&&!m.match(F)&&(x[L]={type:se.pattern,message:w,ref:o,...J(se.pattern,w)},!i))return b(w),x}if(P){if(H(P)){const F=await P(m,t),w=it(F,B);if(w&&(x[L]={...w,...J(se.validate,w.message)},!i))return b(w.message),x}else if(U(P)){let F={};for(const w in P){if(!q(F)&&!i)break;const N=it(await P[w](m,t),B,w);N&&(F={...N,...J(w,N.message)},b(N.message),i&&(x[L]=F))}if(!q(F)&&(x[L]={ref:B,...F},!i))return x}}return b(!0),x};const zt={mode:X.onSubmit,reValidateMode:X.onChange,shouldFocusError:!0};function Gt(e={}){let s={...zt,...e},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:H(s.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1},i={},u=U(s.defaultValues)||U(s.values)?R(s.defaultValues||s.values)||{}:{},n=s.shouldUnregister?{}:R(u),o={action:!1,mount:!1,watch:!1,keepIsValid:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},A,k=0;const j={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},v={...j};let E={...v};const V={array:$e(),state:$e()},P=s.criteriaMode===X.all,L=r=>a=>{clearTimeout(k),k=setTimeout(r,a)},p=async r=>{if(!o.keepIsValid&&!s.disabled&&(v.isValid||E.isValid||r)){let a;s.resolver?(a=q((await re()).errors),M()):a=await J(i,!0),a!==t.isValid&&V.state.next({isValid:a})}},M=(r,a)=>{!s.disabled&&(v.isValidating||v.validatingFields||E.isValidating||E.validatingFields)&&((r||Array.from(c.mount)).forEach(l=>{l&&(a?C(t.validatingFields,l,a):T(t.validatingFields,l))}),V.state.next({validatingFields:t.validatingFields,isValidating:!q(t.validatingFields)}))},m=(r,a=[],l,h,d=!0,f=!0)=>{if(h&&l&&!s.disabled){if(o.action=!0,f&&Array.isArray(y(i,r))){const g=l(y(i,r),h.argA,h.argB);d&&C(i,r,g)}if(f&&Array.isArray(y(t.errors,r))){const g=l(y(t.errors,r),h.argA,h.argB);d&&C(t.errors,r,g),jt(t.errors,r)}if((v.touchedFields||E.touchedFields)&&f&&Array.isArray(y(t.touchedFields,r))){const g=l(y(t.touchedFields,r),h.argA,h.argB);d&&C(t.touchedFields,r,g)}(v.dirtyFields||E.dirtyFields)&&(t.dirtyFields=le(u,n)),V.state.next({name:r,isDirty:F(r,a),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else C(n,r,a)},B=(r,a)=>{C(t.errors,r,a),V.state.next({errors:t.errors})},b=r=>{t.errors=r,V.state.next({errors:t.errors,isValid:!1})},x=(r,a,l,h)=>{const d=y(i,r);if(d){const f=y(n,r,O(l)?y(u,r):l);O(f)||h&&h.defaultChecked||a?C(n,r,a?f:Ze(d._f)):I(r,f),o.mount&&!o.action&&p()}},K=(r,a,l,h,d)=>{let f=!1,g=!1;const D={name:r};if(!s.disabled){if(!l||h){(v.isDirty||E.isDirty)&&(g=t.isDirty,t.isDirty=D.isDirty=F(),f=g!==D.isDirty);const S=Z(y(u,r),a);g=!!y(t.dirtyFields,r),S?T(t.dirtyFields,r):C(t.dirtyFields,r,!0),D.dirtyFields=t.dirtyFields,f=f||(v.dirtyFields||E.dirtyFields)&&g!==!S}if(l){const S=y(t.touchedFields,r);S||(C(t.touchedFields,r,l),D.touchedFields=t.touchedFields,f=f||(v.touchedFields||E.touchedFields)&&S!==l)}f&&d&&V.state.next(D)}return f?D:{}},te=(r,a,l,h)=>{const d=y(t.errors,r),f=(v.isValid||E.isValid)&&Y(a)&&t.isValid!==a;if(s.delayError&&l?(A=L(()=>B(r,l)),A(s.delayError)):(clearTimeout(k),A=null,l?C(t.errors,r,l):T(t.errors,r)),(l?!Z(d,l):d)||!q(h)||f){const g={...h,...f&&Y(a)?{isValid:a}:{},errors:t.errors,name:r};t={...t,...g},V.state.next(g)}},re=async r=>(M(r,!0),await s.resolver(n,s.context,It(r||c.mount,i,s.criteriaMode,s.shouldUseNativeValidation))),ee=async r=>{const{errors:a}=await re(r);if(M(r),r)for(const l of r){const h=y(a,l);h?C(t.errors,l,h):T(t.errors,l)}else t.errors=a;return a},J=async(r,a,l={valid:!0})=>{for(const h in r){const d=r[h];if(d){const{_f:f,...g}=d;if(f){const D=c.array.has(f.name),S=d._f&&Pt(d._f);S&&v.validatingFields&&M([f.name],!0);const W=await at(d,c.disabled,n,P,s.shouldUseNativeValidation&&!a,D);if(S&&v.validatingFields&&M([f.name]),W[f.name]&&(l.valid=!1,a||e.shouldUseNativeValidation))break;!a&&(y(W,f.name)?D?Kt(t.errors,W,f.name):C(t.errors,f.name,W[f.name]):T(t.errors,f.name))}!q(g)&&await J(g,a,l)}}return l.valid},ve=()=>{for(const r of c.unMount){const a=y(i,r);a&&(a._f.refs?a._f.refs.every(l=>!Ee(l)):!Ee(a._f.ref))&&Fe(r)}c.unMount=new Set},F=(r,a)=>!s.disabled&&(r&&a&&C(n,r,a),!Z(Ie(),u)),w=(r,a,l)=>De(r,c,{...o.mount?n:O(a)?u:$(r)?{[r]:a}:a},l,a),N=r=>Re(y(o.mount?n:u,r,s.shouldUnregister?y(u,r,[]):[])),I=(r,a,l={})=>{const h=y(i,r);let d=a;if(h){const f=h._f;f&&(!f.disabled&&C(n,r,vt(a,f)),d=Ve(f.ref)&&z(a)?"":a,yt(f.ref)?[...f.ref.options].forEach(g=>g.selected=d.includes(g.value)):f.refs?ge(f.ref)?f.refs.forEach(g=>{(!g.defaultChecked||!g.disabled)&&(Array.isArray(d)?g.checked=!!d.find(D=>D===g.value):g.checked=d===g.value||!!d)}):f.refs.forEach(g=>g.checked=g.value===d):Ne(f.ref)?f.ref.value="":(f.ref.value=d,f.ref.type||V.state.next({name:r,values:R(n)})))}(l.shouldDirty||l.shouldTouch)&&K(r,d,l.shouldTouch,l.shouldDirty,!0),l.shouldValidate&&ce(r)},Q=(r,a,l)=>{for(const h in a){if(!a.hasOwnProperty(h))return;const d=a[h],f=r+"."+h,g=y(i,f);(c.array.has(r)||U(d)||g&&!g._f)&&!ne(d)?Q(f,d,l):I(f,d,l)}},G=(r,a,l={})=>{const h=y(i,r),d=c.array.has(r),f=R(a);C(n,r,f),d?(V.array.next({name:r,values:R(n)}),(v.isDirty||v.dirtyFields||E.isDirty||E.dirtyFields)&&l.shouldDirty&&V.state.next({name:r,dirtyFields:le(u,n),isDirty:F(r,f)})):h&&!h._f&&!z(f)?Q(r,f,l):I(r,f,l),rt(r,c)?V.state.next({...t,name:r,values:R(n)}):V.state.next({name:o.mount?r:void 0,values:R(n)})},oe=async r=>{o.mount=!0;const a=r.target;let l=a.name,h=!0;const d=y(i,l),f=S=>{h=Number.isNaN(S)||ne(S)&&isNaN(S.getTime())||Z(S,y(n,l,S))},g=et(s.mode),D=et(s.reValidateMode);if(d){let S,W;const ae=a.type?Ze(d._f):lt(r),ie=r.type===_e.BLUR||r.type===_e.FOCUS_OUT,Et=!Bt(d._f)&&!s.resolver&&!y(t.errors,l)&&!d._f.deps||Ht(ie,y(t.touchedFields,l),t.isSubmitted,D,g),we=rt(l,c,ie);C(n,l,ae),ie?(!a||!a.readOnly)&&(d._f.onBlur&&d._f.onBlur(r),A&&A(0)):d._f.onChange&&d._f.onChange(r);const ke=K(l,ae,ie),Dt=!q(ke)||we;if(!ie&&V.state.next({name:l,type:r.type,values:R(n)}),Et)return(v.isValid||E.isValid)&&(s.mode==="onBlur"?ie&&p():ie||p()),Dt&&V.state.next({name:l,...we?{}:ke});if(!ie&&we&&V.state.next({...t}),s.resolver){const{errors:Ge}=await re([l]);if(M([l]),f(ae),h){const St=st(t.errors,i,l),Ye=st(Ge,i,St.name||l);S=Ye.error,l=Ye.name,W=q(Ge)}}else M([l],!0),S=(await at(d,c.disabled,n,P,s.shouldUseNativeValidation))[l],M([l]),f(ae),h&&(S?W=!1:(v.isValid||E.isValid)&&(W=await J(i,!0)));h&&(d._f.deps&&(!Array.isArray(d._f.deps)||d._f.deps.length>0)&&ce(d._f.deps),te(l,W,S,ke))}},fe=(r,a)=>{if(y(t.errors,a)&&r.focus)return r.focus(),1},ce=async(r,a={})=>{let l,h;const d=ye(r);if(s.resolver){const f=await ee(O(r)?r:d);l=q(f),h=r?!d.some(g=>y(f,g)):l}else r?(h=(await Promise.all(d.map(async f=>{const g=y(i,f);return await J(g&&g._f?{[f]:g}:g)}))).every(Boolean),!(!h&&!t.isValid)&&p()):h=l=await J(i);return V.state.next({...!$(r)||(v.isValid||E.isValid)&&l!==t.isValid?{}:{name:r},...s.resolver||!r?{isValid:l}:{},errors:t.errors}),a.shouldFocus&&!h&&he(i,fe,r?d:c.mount),h},Ie=(r,a)=>{let l={...o.mount?n:u};return a&&(l=dt(a.dirtyFields?t.dirtyFields:t.touchedFields,l)),O(r)?l:$(r)?y(l,r):r.map(h=>y(l,h))},Pe=(r,a)=>({invalid:!!y((a||t).errors,r),isDirty:!!y((a||t).dirtyFields,r),error:y((a||t).errors,r),isValidating:!!y(t.validatingFields,r),isTouched:!!y((a||t).touchedFields,r)}),mt=r=>{r&&ye(r).forEach(a=>T(t.errors,a)),V.state.next({errors:r?t.errors:{}})},Be=(r,a,l)=>{const h=(y(i,r,{_f:{}})._f||{}).ref,d=y(t.errors,r)||{},{ref:f,message:g,type:D,...S}=d;C(t.errors,r,{...S,...a,ref:h}),V.state.next({name:r,errors:t.errors,isValid:!1}),l&&l.shouldFocus&&h&&h.focus&&h.focus()},bt=(r,a)=>H(r)?V.state.subscribe({next:l=>"values"in l&&r(w(void 0,a),l)}):w(r,a,!0),We=r=>V.state.subscribe({next:a=>{qt(r.name,a.name,r.exact)&&Wt(a,r.formState||v,kt,r.reRenderRoot)&&r.callback({values:{...n},...t,...a,defaultValues:u})}}).unsubscribe,Ft=r=>(o.mount=!0,E={...E,...r.formState},We({...r,formState:{...j,...r.formState}})),Fe=(r,a={})=>{for(const l of r?ye(r):c.mount)c.mount.delete(l),c.array.delete(l),a.keepValue||(T(i,l),T(n,l)),!a.keepError&&T(t.errors,l),!a.keepDirty&&T(t.dirtyFields,l),!a.keepTouched&&T(t.touchedFields,l),!a.keepIsValidating&&T(t.validatingFields,l),!s.shouldUnregister&&!a.keepDefaultValue&&T(u,l);V.state.next({values:R(n)}),V.state.next({...t,...a.keepDirty?{isDirty:F()}:{}}),!a.keepIsValid&&p()},qe=({disabled:r,name:a})=>{(Y(r)&&o.mount||r||c.disabled.has(a))&&(r?c.disabled.add(a):c.disabled.delete(a))},Ae=(r,a={})=>{let l=y(i,r);const h=Y(a.disabled)||Y(s.disabled);return C(i,r,{...l||{},_f:{...l&&l._f?l._f:{ref:{name:r}},name:r,mount:!0,...a}}),c.mount.add(r),l?qe({disabled:Y(a.disabled)?a.disabled:s.disabled,name:r}):x(r,!0,a.value),{...h?{disabled:a.disabled||s.disabled}:{},...s.progressive?{required:!!a.required,min:de(a.min),max:de(a.max),minLength:de(a.minLength),maxLength:de(a.maxLength),pattern:de(a.pattern)}:{},name:r,onChange:oe,onBlur:oe,ref:d=>{if(d){Ae(r,a),l=y(i,r);const f=O(d.value)&&d.querySelectorAll&&d.querySelectorAll("input,select,textarea")[0]||d,g=Lt(f),D=l._f.refs||[];if(g?D.find(S=>S===f):f===l._f.ref)return;C(i,r,{_f:{...l._f,...g?{refs:[...D.filter(Ee),f,...Array.isArray(y(u,r))?[{}]:[]],ref:{type:f.type,name:r}}:{ref:f}}}),x(r,!1,void 0,f)}else l=y(i,r,{}),l._f&&(l._f.mount=!1),(s.shouldUnregister||a.shouldUnregister)&&!(ot(c.array,r)&&o.action)&&c.unMount.add(r)}}},xe=()=>s.shouldFocusError&&he(i,fe,c.mount),At=r=>{Y(r)&&(V.state.next({disabled:r}),he(i,(a,l)=>{const h=y(i,l);h&&(a.disabled=h._f.disabled||r,Array.isArray(h._f.refs)&&h._f.refs.forEach(d=>{d.disabled=h._f.disabled||r}))},0,!1))},He=(r,a)=>async l=>{let h;l&&(l.preventDefault&&l.preventDefault(),l.persist&&l.persist());let d=R(n);if(V.state.next({isSubmitting:!0}),s.resolver){const{errors:f,values:g}=await re();M(),t.errors=f,d=R(g)}else await J(i);if(c.disabled.size)for(const f of c.disabled)T(d,f);if(T(t.errors,"root"),q(t.errors)){V.state.next({errors:{}});try{await r(d,l)}catch(f){h=f}}else a&&await a({...t.errors},l),xe(),setTimeout(xe);if(V.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:q(t.errors)&&!h,submitCount:t.submitCount+1,errors:t.errors}),h)throw h},xt=(r,a={})=>{y(i,r)&&(O(a.defaultValue)?G(r,R(y(u,r))):(G(r,a.defaultValue),C(u,r,R(a.defaultValue))),a.keepTouched||T(t.touchedFields,r),a.keepDirty||(T(t.dirtyFields,r),t.isDirty=a.defaultValue?F(r,R(y(u,r))):F()),a.keepError||(T(t.errors,r),v.isValid&&p()),V.state.next({...t}))},je=(r,a={})=>{const l=r?R(r):u,h=R(l),d=q(r),f=d?u:h;if(a.keepDefaultValues||(u=l),!a.keepValues){if(a.keepDirtyValues){const g=new Set([...c.mount,...Object.keys(le(u,n))]);for(const D of Array.from(g)){const S=y(t.dirtyFields,D),W=y(n,D),ae=y(f,D);S&&!O(W)?C(f,D,W):!S&&!O(ae)&&G(D,ae)}}else{if(Oe&&O(r))for(const g of c.mount){const D=y(i,g);if(D&&D._f){const S=Array.isArray(D._f.refs)?D._f.refs[0]:D._f.ref;if(Ve(S)){const W=S.closest("form");if(W){W.reset();break}}}}if(a.keepFieldsRef)for(const g of c.mount)G(g,y(f,g));else i={}}n=s.shouldUnregister?a.keepDefaultValues?R(u):{}:R(f),V.array.next({values:{...f}}),V.state.next({values:{...f}})}c={mount:a.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!v.isValid||!!a.keepIsValid||!!a.keepDirtyValues||!s.shouldUnregister&&!q(f),o.watch=!!s.shouldUnregister,o.keepIsValid=!!a.keepIsValid,o.action=!1,a.keepErrors||(t.errors={}),V.state.next({submitCount:a.keepSubmitCount?t.submitCount:0,isDirty:d?!1:a.keepDirty?t.isDirty:!!(a.keepDefaultValues&&!Z(r,u)),isSubmitted:a.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:d?{}:a.keepDirtyValues?a.keepDefaultValues&&n?le(u,n):t.dirtyFields:a.keepDefaultValues&&r?le(u,r):a.keepDirty?t.dirtyFields:{},touchedFields:a.keepTouched?t.touchedFields:{},errors:a.keepErrors?t.errors:{},isSubmitSuccessful:a.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:u})},Ke=(r,a)=>je(H(r)?r(n):r,{...s.resetOptions,...a}),wt=(r,a={})=>{const l=y(i,r),h=l&&l._f;if(h){const d=h.refs?h.refs[0]:h.ref;d.focus&&setTimeout(()=>{d.focus(),a.shouldSelect&&H(d.select)&&d.select()})}},kt=r=>{t={...t,...r}},ze={control:{register:Ae,unregister:Fe,getFieldState:Pe,handleSubmit:He,setError:Be,_subscribe:We,_runSchema:re,_updateIsValidating:M,_focusError:xe,_getWatch:w,_getDirty:F,_setValid:p,_setFieldArray:m,_setDisabledField:qe,_setErrors:b,_getFieldArray:N,_reset:je,_resetDefaultValues:()=>H(s.defaultValues)&&s.defaultValues().then(r=>{Ke(r,s.resetOptions),V.state.next({isLoading:!1})}),_removeUnmounted:ve,_disableForm:At,_subjects:V,_proxyFormState:v,get _fields(){return i},get _formValues(){return n},get _state(){return o},set _state(r){o=r},get _defaultValues(){return u},get _names(){return c},set _names(r){c=r},get _formState(){return t},get _options(){return s},set _options(r){s={...s,...r}}},subscribe:Ft,trigger:ce,register:Ae,handleSubmit:He,watch:bt,setValue:G,getValues:Ie,reset:Ke,resetField:xt,clearErrors:mt,unregister:Fe,setError:Be,setFocus:wt,getFieldState:Pe};return{...ze,formControl:ze}}function tr(e={}){const s=_.useRef(void 0),t=_.useRef(void 0),[i,u]=_.useState({isDirty:!1,isValidating:!1,isLoading:H(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:H(e.defaultValues)?void 0:e.defaultValues});if(!s.current)if(e.formControl)s.current={...e.formControl,formState:i},e.defaultValues&&!H(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:o,...c}=Gt(e);s.current={...c,formState:i}}const n=s.current.control;return n._options=e,Me(()=>{const o=n._subscribe({formState:n._proxyFormState,callback:()=>u({...n._formState}),reRenderRoot:!0});return u(c=>({...c,isReady:!0})),n._formState.isReady=!0,o},[n]),_.useEffect(()=>n._disableForm(e.disabled),[n,e.disabled]),_.useEffect(()=>{e.mode&&(n._options.mode=e.mode),e.reValidateMode&&(n._options.reValidateMode=e.reValidateMode)},[n,e.mode,e.reValidateMode]),_.useEffect(()=>{e.errors&&(n._setErrors(e.errors),n._focusError())},[n,e.errors]),_.useEffect(()=>{e.shouldUnregister&&n._subjects.state.next({values:n._getWatch()})},[n,e.shouldUnregister]),_.useEffect(()=>{if(n._proxyFormState.isDirty){const o=n._getDirty();o!==i.isDirty&&n._subjects.state.next({isDirty:o})}},[n,i.isDirty]),_.useEffect(()=>{var o;e.values&&!Z(e.values,t.current)?(n._reset(e.values,{keepFieldsRef:!0,...n._options.resetOptions}),!((o=n._options.resetOptions)===null||o===void 0)&&o.keepIsValid||n._setValid(),t.current=e.values,u(c=>({...c}))):n._resetDefaultValues()},[n,e.values]),_.useEffect(()=>{n._state.mount||(n._setValid(),n._state.mount=!0),n._state.watch&&(n._state.watch=!1,n._subjects.state.next({...n._formState})),n._removeUnmounted()}),s.current.formState=ft(i,n),s.current}const nt=(e,s,t)=>{if(e&&"reportValidity"in e){const i=y(t,s);e.setCustomValidity(i&&i.message||""),e.reportValidity()}},Vt=(e,s)=>{for(const t in s.fields){const i=s.fields[t];i&&i.ref&&"reportValidity"in i.ref?nt(i.ref,t,e):i.refs&&i.refs.forEach(u=>nt(u,t,e))}},Yt=(e,s)=>{s.shouldUseNativeValidation&&Vt(e,s);const t={};for(const i in e){const u=y(s.fields,i),n=Object.assign(e[i]||{},{ref:u&&u.ref});if($t(s.names||Object.keys(e),i)){const o=Object.assign({},y(t,i));C(o,"root",n),C(t,i,o)}else C(t,i,n)}return t},$t=(e,s)=>e.some(t=>t.startsWith(s+"."));var Jt=function(e,s){for(var t={};e.length;){var i=e[0],u=i.code,n=i.message,o=i.path.join(".");if(!t[o])if("unionErrors"in i){var c=i.unionErrors[0].errors[0];t[o]={message:c.message,type:c.code}}else t[o]={message:n,type:u};if("unionErrors"in i&&i.unionErrors.forEach(function(j){return j.errors.forEach(function(v){return e.push(v)})}),s){var A=t[o].types,k=A&&A[i.code];t[o]=ct(o,s,t,u,k?[].concat(k,i.message):i.message)}e.shift()}return t},rr=function(e,s,t){return t===void 0&&(t={}),function(i,u,n){try{return Promise.resolve(function(o,c){try{var A=Promise.resolve(e[t.mode==="sync"?"parse":"parseAsync"](i,s)).then(function(k){return n.shouldUseNativeValidation&&Vt({},n),{errors:{},values:t.raw?i:k}})}catch(k){return c(k)}return A&&A.then?A.then(void 0,c):A}(0,function(o){if(function(c){return Array.isArray(c==null?void 0:c.errors)}(o))return{values:{},errors:Yt(Jt(o.errors,!n.shouldUseNativeValidation&&n.criteriaMode==="all"),n)};throw o}))}catch(o){return Promise.reject(o)}}};export{er as C,Zt as F,Le as a,rr as t,tr as u};
