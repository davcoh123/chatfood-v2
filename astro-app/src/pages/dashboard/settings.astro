---
import DashboardLayout from '@/layouts/DashboardLayout.astro';
import { DashboardRoot } from '@/components/react/providers/DashboardRoot';
import SettingsPage from '@/components/react/SettingsPage';
import { Toaster } from '@/components/ui/toaster';

// Get user, session, profile from middleware locals
const user = (Astro.locals as any).user;
const session = (Astro.locals as any).session;
const profile = (Astro.locals as any).profile;

if (!user) {
  return Astro.redirect('/login?redirect=/dashboard/settings');
}
---

<DashboardLayout title="Paramètres">
  <div class="space-y-6">
    <div>
      <h1 class="text-2xl md:text-3xl font-bold">Paramètres</h1>
      <p class="text-gray-500 mt-2">
        Configurez votre restaurant et votre compte
      </p>
    </div>
    
    <DashboardRoot client:only="react" user={user} session={session} profile={profile}>
      <SettingsPage />
      <Toaster />
    </DashboardRoot>
  </div>
</DashboardLayout>
